<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.18">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Cory McCartan">

<title>2022 Midterms - House Forecast</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<link href="./flag.gif" rel="icon" type="image/gif">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-2KH5JZ6JS1"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
 
  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'analytics_storage': 'denied'
  });
gtag('config', 'G-2KH5JZ6JS1', { 'anonymize_ip': true});
</script>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <img src="./flag.gif" alt="">
    <span class="navbar-title">2022 Midterms</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./house.html" aria-current="page">House</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./senate.html">Senate</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/CoryMcCartan/midterms-22/"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 </a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">House Forecast</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Cory McCartan </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<div class="cell" data-include="false">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="11" data-source-offset="-0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 10;"><span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { fmt_pct<span class="op">,</span> rate<span class="op">,</span> fmt_surname<span class="op">,</span> AP } <span class="im">from</span> <span class="st">"./utils.js"</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>d_sum <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"summary.json"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>geom_hex <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"hex.json"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>d_history <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"history.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({<span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>d_hist <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"seats_hist_house.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({<span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>d_distr_list <span class="op">=</span> {</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> raw <span class="op">=</span> <span class="cf">await</span> <span class="fu">FileAttachment</span>(<span class="st">"house_districts.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({<span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> raw<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> {</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> at_large <span class="op">=</span> [<span class="st">"AK"</span><span class="op">,</span> <span class="st">"DE"</span><span class="op">,</span> <span class="st">"ND"</span><span class="op">,</span> <span class="st">"SD"</span><span class="op">,</span> <span class="st">"VT"</span><span class="op">,</span> <span class="st">"WY"</span>]<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">state</span>)<span class="op">;</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">name</span> <span class="op">=</span> AP[d<span class="op">.</span><span class="at">state</span>] <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> (at_large <span class="op">?</span> <span class="st">"At-Large"</span> <span class="op">:</span> d<span class="op">.</span><span class="at">district</span>)<span class="op">;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">name_short</span> <span class="op">=</span> AP[d<span class="op">.</span><span class="at">state</span>] <span class="op">+</span>  (at_large <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> <span class="st">" "</span> <span class="op">+</span> d<span class="op">.</span><span class="at">district</span>)<span class="op">;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">rcv</span> <span class="op">=</span> [<span class="st">"AK"</span><span class="op">,</span> <span class="st">"ME"</span>]<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">state</span>)<span class="op">;</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">interval</span> <span class="op">=</span> [d<span class="op">.</span><span class="at">dem_mean</span><span class="op">,</span> d<span class="op">.</span><span class="at">dem_q10</span><span class="op">,</span> d<span class="op">.</span><span class="at">dem_q25</span><span class="op">,</span> d<span class="op">.</span><span class="at">dem_q75</span><span class="op">,</span> d<span class="op">.</span><span class="at">dem_q90</span><span class="op">,</span> d<span class="op">.</span><span class="at">rcv</span>]<span class="op">;</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">rating</span> <span class="op">=</span> <span class="fu">rate</span>(d<span class="op">.</span><span class="at">pr_dem</span>)<span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">margin</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(d<span class="op">.</span><span class="at">dem_mean</span> <span class="op">-</span> <span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">dem_cand</span> <span class="op">=</span> <span class="fu">fmt_surname</span>(d<span class="op">.</span><span class="at">dem_cand</span>)<span class="op">;</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">rep_cand</span> <span class="op">=</span> <span class="fu">fmt_surname</span>(d<span class="op">.</span><span class="at">rep_cand</span>)<span class="op">;</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (d<span class="op">.</span><span class="at">state</span> <span class="op">==</span> <span class="st">"AK"</span>) {</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>            d<span class="op">.</span><span class="at">dem_cand</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>            d<span class="op">.</span><span class="at">rep_cand</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">cands</span> <span class="op">=</span> [d<span class="op">.</span><span class="at">dem_cand</span><span class="op">,</span> d<span class="op">.</span><span class="at">rep_cand</span><span class="op">,</span> d<span class="op">.</span><span class="at">inc_seat</span>]<span class="op">;</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">search</span> <span class="op">=</span> {<span class="dt">dem</span><span class="op">:</span> <span class="st">"incumbent dem. "</span><span class="op">,</span> <span class="dt">open</span><span class="op">:</span> <span class="st">"open seat "</span><span class="op">,</span> <span class="dt">gop</span><span class="op">:</span> <span class="st">"incumbent rep. incumbent gop. "</span>}[d<span class="op">.</span><span class="at">inc_seat</span>] </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>                <span class="op">+</span> [<span class="st">"contested "</span><span class="op">,</span> <span class="st">"unopposed uncontested "</span>][d<span class="op">.</span><span class="at">unopp</span>]<span class="op">;</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>d_distr <span class="op">=</span> d3<span class="op">.</span><span class="fu">index</span>(d_distr_list<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">state</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">district</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>DARK_BLUE <span class="op">=</span> <span class="st">"#0063B1"</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>DARK_RED <span class="op">=</span> <span class="st">"#A0442C"</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>BLUE <span class="op">=</span> <span class="st">"#3D77BB"</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>RED <span class="op">=</span> <span class="st">"#B25D4C"</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>w_BODY <span class="op">=</span> <span class="dv">796</span><span class="op">;</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>SMALL <span class="op">=</span> width <span class="op">&lt;</span> <span class="dv">600</span><span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>elec_date <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="st">"2022-11-08"</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>color <span class="op">=</span> {</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> midpt <span class="op">=</span> <span class="st">"#fafffa"</span><span class="op">;</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> color_dem <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">domain</span>([<span class="fl">0.5</span><span class="op">,</span> <span class="fl">1.0</span>])</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>([midpt<span class="op">,</span> DARK_BLUE])<span class="op">;</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> color_gop <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">domain</span>([<span class="fl">0.0</span><span class="op">,</span> <span class="fl">0.5</span>])</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>([DARK_RED<span class="op">,</span> midpt])<span class="op">;</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="kw">=&gt;</span> x <span class="op">&lt;=</span> <span class="fl">0.5</span> <span class="op">?</span> <span class="fu">color_gop</span>(x) <span class="op">:</span> <span class="fu">color_dem</span>(x)<span class="op">;</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-16" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="66" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 65;"><span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> exag_fac <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(width)<span class="op">/</span><span class="dv">80</span><span class="op">;</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> last_elec <span class="op">=</span> <span class="dv">222</span><span class="op">;</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> xmin <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d_sum<span class="op">.</span><span class="at">house_q10</span><span class="op">*</span>exag_fac<span class="op">,</span> <span class="dv">218</span> <span class="op">-</span> <span class="dv">10</span>)<span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> xmax <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d_sum<span class="op">.</span><span class="at">house_q90</span><span class="op">/</span>exag_fac<span class="op">,</span> <span class="dv">218</span> <span class="op">+</span> <span class="dv">10</span>)<span class="op">,</span> <span class="dv">435</span>)</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> s_gain <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(last_elec <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(d_sum<span class="op">.</span><span class="at">house_med</span>))<span class="op">;</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> overl <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="fl">0.58</span><span class="op">,</span> <span class="dv">1</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(width) <span class="op">/</span> <span class="dv">80</span>)<span class="op">;</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> text_shadow <span class="op">=</span> <span class="kw">function</span>(text<span class="op">,</span> opt) {</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> opt2 <span class="op">=</span> {<span class="op">...</span>opt}</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    opt2<span class="op">.</span><span class="at">dx</span> <span class="op">=</span> opt2<span class="op">.</span><span class="at">dx</span> <span class="op">+</span> <span class="dv">3</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>    opt2<span class="op">.</span><span class="at">dy</span> <span class="op">=</span> opt2<span class="op">.</span><span class="at">dy</span> <span class="op">+</span> <span class="dv">3</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    opt2<span class="op">.</span><span class="at">fill</span> <span class="op">=</span> <span class="st">"#0007"</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [Plot<span class="op">.</span><span class="fu">text</span>([text]<span class="op">,</span> opt2)<span class="op">,</span> Plot<span class="op">.</span><span class="fu">text</span>([text]<span class="op">,</span> opt)]</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="at">plot</span> <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> [xmin<span class="op">,</span> xmax]<span class="op">,</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>        <span class="dt">clamp</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>        <span class="dt">inset</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>        <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>        <span class="dt">legend</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>        <span class="dt">axis</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>        <span class="dt">insetTop</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>        <span class="dt">legend</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">rectY</span>(d_hist<span class="op">,</span> {</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>                <span class="dt">x1</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">dem_seats</span> <span class="op">-</span> overl<span class="op">,</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>                <span class="dt">x2</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">dem_seats</span> <span class="op">+</span> overl<span class="op">,</span></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>                <span class="dt">y</span><span class="op">:</span> <span class="st">"pr"</span><span class="op">,</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>                <span class="dt">fill</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">dem_seats</span> <span class="op">&gt;=</span> <span class="dv">218</span> <span class="op">?</span> BLUE <span class="op">:</span> RED<span class="op">,</span></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>]<span class="op">,</span> {</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>            <span class="dt">dy</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>            <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x1</span><span class="op">:</span> d_sum<span class="op">.</span><span class="at">house_q10</span><span class="op">,</span></span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x2</span><span class="op">:</span> d_sum<span class="op">.</span><span class="at">house_q90</span><span class="op">,</span></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>            <span class="dt">color</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">ruleX</span>([last_elec<span class="op">,</span> d_sum<span class="op">.</span><span class="at">house_med</span>])<span class="op">,</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>        <span class="fu">text_shadow</span>(s_gain<span class="op">,</span> { </span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> d_sum<span class="op">.</span><span class="at">house_med</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">48</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>            <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>        <span class="fu">text_shadow</span>(<span class="st">"LOSS"</span><span class="op">,</span> { </span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> d_sum<span class="op">.</span><span class="at">house_med</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">42</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>            <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">14</span><span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">text</span>([<span class="st">"← DEM. MAJORITY"</span>]<span class="op">,</span> { </span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="fl">217.5</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="op">-</span><span class="dv">3</span><span class="op">,</span></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>            <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"end"</span><span class="op">,</span></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#111"</span><span class="op">,</span></span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">text</span>([<span class="st">"REP. MAJORITY →"</span>]<span class="op">,</span> { </span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="fl">217.5</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>            <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span></span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#111"</span><span class="op">,</span></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>         Plot<span class="op">.</span><span class="fu">text</span>([last_elec <span class="op">+</span> <span class="st">" LAST ELECTION"</span>]<span class="op">,</span> { </span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> last_elec<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>            <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"middle"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>         Plot<span class="op">.</span><span class="fu">text</span>([<span class="st">"← DEM. SEATS"</span>]<span class="op">,</span> { </span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> xmax<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span> <span class="op">-</span> (SMALL <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">0</span>)<span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>            <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span></span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> width<span class="op">,</span></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="dv">240</span><span class="op">,</span></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginRight</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>    <span class="dt">style</span><span class="op">:</span> {</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">9</span><span class="op">,</span></span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> <span class="st">"#444"</span><span class="op">,</span></span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>        <span class="dt">overflow</span><span class="op">:</span> <span class="st">"visible"</span><span class="op">,</span></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> <span class="bu">window</span><span class="op">.</span><span class="at">plot</span><span class="op">;</span></span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="plot-hist" class="cell-output cell-output-display column-screen">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
</div>
<div class="banner page-columns page-full">
<div id="summary" class="cell page-columns page-full">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="168" data-source-offset="-1"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 167;"><span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>dem_lead <span class="op">=</span> <span class="kw">true</span><span class="op">;</span> <span class="co">// d_sum.house_prob &gt; 0.5</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> win_party <span class="op">=</span> dem_lead <span class="op">?</span> <span class="st">"Democrats"</span> <span class="op">:</span> <span class="st">"Republicans"</span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> win_class <span class="op">=</span> dem_lead <span class="op">?</span> <span class="st">"dem"</span> <span class="op">:</span> <span class="st">"rep"</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> min_seats <span class="op">=</span> dem_lead <span class="op">?</span> d_sum<span class="op">.</span><span class="at">house_q10</span> <span class="op">:</span> <span class="dv">435</span> <span class="op">-</span> d_sum<span class="op">.</span><span class="at">house_q90</span></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> max_seats <span class="op">=</span> dem_lead <span class="op">?</span> d_sum<span class="op">.</span><span class="at">house_q90</span> <span class="op">:</span> <span class="dv">435</span> <span class="op">-</span> d_sum<span class="op">.</span><span class="at">house_q10</span></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> phrase <span class="op">=</span> dem_lead <span class="op">?</span> <span class="st">"controlling"</span> <span class="op">:</span> <span class="st">"flipping"</span></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> prob <span class="op">=</span> dem_lead <span class="op">?</span> d_sum<span class="op">.</span><span class="at">house_prob</span> <span class="op">:</span> <span class="dv">1</span> <span class="op">-</span> d_sum<span class="op">.</span><span class="at">house_prob</span></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> timestamp <span class="op">=</span> d_history[d_history<span class="op">.</span><span class="at">length</span><span class="op">-</span><span class="dv">1</span>]<span class="op">.</span><span class="at">timestamp</span><span class="op">;</span></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> date_fmt <span class="op">=</span> timestamp<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"en-US"</span><span class="op">,</span> { </span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>            <span class="dt">weekday</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span> </span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>            <span class="dt">month</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span> </span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>            <span class="dt">day</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span> </span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>            <span class="dt">hour</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span> </span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>            <span class="dt">minute</span><span class="op">:</span> <span class="st">"numeric"</span><span class="op">,</span></span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>            <span class="dt">timeZoneName</span><span class="op">:</span> <span class="st">"short"</span><span class="op">,</span></span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>            })       </span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">md</span><span class="vs">`</span></span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a><span class="vs">The &lt;b class="</span><span class="sc">${</span>win_class<span class="sc">}</span><span class="vs">"&gt;</span><span class="sc">${</span>win_party<span class="sc">}</span><span class="vs">&lt;/b&gt; are expected to win</span></span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a><span class="vs">**between </span><span class="sc">${</span>min_seats<span class="sc">}</span><span class="vs"> and </span><span class="sc">${</span>max_seats<span class="sc">}</span><span class="vs"> seats**.</span></span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a><span class="vs">They have a **</span><span class="sc">${</span><span class="fu">fmt_pct</span>(prob)<span class="sc">}</span><span class="vs"> chance** of </span><span class="sc">${</span>phrase<span class="sc">}</span><span class="vs"> the House.</span></span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;p class="updated"&gt;Last updated </span><span class="sc">${</span>date_fmt<span class="sc">}</span><span class="vs">.&lt;/p&gt;`</span><span class="op">;</span></span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="cell-output cell-output-display column-screen">
<div id="summary-1">
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="summary-2">
<div id="ojs-cell-3-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<!--
<div class="alert alert-dismissible alert-danger" style="margin-top: 1rem;">
<strong>NEW</strong><br /><hr />
<span style="color: black;">Look at this.</span>
</div>
-->
<section id="map" class="level2 page-columns page-full">
<h2 data-anchor-id="map">The House map</h2>
<p>Each district is shaded by the probability of a Democratic or Republican win. Cross-hatching indicates an incumbent who has a 50% or higher chance of losing. You can hover over a district to learn more.</p>
<div class="column-screen">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="213" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 212;"><span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> distrs <span class="op">=</span> topojson<span class="op">.</span><span class="fu">feature</span>(geom_hex<span class="op">,</span> geom_hex<span class="op">.</span><span class="at">objects</span><span class="op">.</span><span class="at">foo</span>)<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> {</span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">match</span> <span class="op">=</span> d_distr<span class="op">.</span><span class="fu">get</span>(d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">state</span>)<span class="op">.</span><span class="fu">get</span>(d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">district</span>)<span class="op">;</span></span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">flip</span> <span class="op">=</span> ((d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">pr_dem</span> <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">inc_seat</span> <span class="op">==</span> <span class="st">"gop"</span>) </span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a>                <span class="op">||</span> (d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">pr_dem</span> <span class="op">&lt;</span> <span class="fl">0.5</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">inc_seat</span> <span class="op">==</span> <span class="st">"dem"</span>))</span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>            <span class="op">&amp;&amp;</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">pr_dem</span> <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">&gt;</span> <span class="fl">0.01</span>)<span class="op">;</span></span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> w <span class="op">=</span> <span class="dv">960</span><span class="op">;</span></span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> h <span class="op">=</span> w <span class="op">*</span> <span class="fl">0.72</span><span class="op">;</span></span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> GOLD <span class="op">=</span> <span class="st">"#bc1"</span><span class="op">;</span></span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> w<span class="op">,</span> h])</span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"width"</span><span class="op">,</span> <span class="st">"100%"</span>)</span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"height"</span><span class="op">,</span> <span class="st">"auto"</span>)<span class="op">;</span></span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-232"><a href="#cb4-232" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> proj <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoAlbers</span>()</span>
<span id="cb4-233"><a href="#cb4-233" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scale</span>(<span class="fl">0.9</span><span class="op">*</span>w)</span>
<span id="cb4-234"><a href="#cb4-234" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">translate</span>([<span class="fl">0.97</span><span class="op">*</span>w<span class="op">/</span><span class="dv">2</span><span class="op">,</span> <span class="fl">0.91</span><span class="op">*</span>h<span class="op">/</span><span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb4-235"><a href="#cb4-235" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> path <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(proj)<span class="op">;</span></span>
<span id="cb4-236"><a href="#cb4-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-237"><a href="#cb4-237" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> geom_distrs <span class="op">=</span> svg</span>
<span id="cb4-238"><a href="#cb4-238" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb4-239"><a href="#cb4-239" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"distrs"</span>)</span>
<span id="cb4-240"><a href="#cb4-240" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"path"</span>)</span>
<span id="cb4-241"><a href="#cb4-241" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(distrs)</span>
<span id="cb4-242"><a href="#cb4-242" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb4-243"><a href="#cb4-243" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">color</span>(d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">pr_dem</span>))</span>
<span id="cb4-244"><a href="#cb4-244" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#111"</span>)</span>
<span id="cb4-245"><a href="#cb4-245" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">0.5</span>)</span>
<span id="cb4-246"><a href="#cb4-246" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> path)<span class="op">;</span></span>
<span id="cb4-247"><a href="#cb4-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-248"><a href="#cb4-248" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> geom_distrs_hover <span class="op">=</span> svg</span>
<span id="cb4-249"><a href="#cb4-249" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb4-250"><a href="#cb4-250" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"distrs"</span>)</span>
<span id="cb4-251"><a href="#cb4-251" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"path"</span>)</span>
<span id="cb4-252"><a href="#cb4-252" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(distrs)</span>
<span id="cb4-253"><a href="#cb4-253" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb4-254"><a href="#cb4-254" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">flip</span> <span class="op">?</span> <span class="st">"url(#diagonalHatch)"</span> <span class="op">:</span> <span class="st">"none"</span>)</span>
<span id="cb4-255"><a href="#cb4-255" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#000"</span>)</span>
<span id="cb4-256"><a href="#cb4-256" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">0.0</span>)</span>
<span id="cb4-257"><a href="#cb4-257" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> path)<span class="op">;</span>    </span>
<span id="cb4-258"><a href="#cb4-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-259"><a href="#cb4-259" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> tt <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">"#plot-map"</span>)<span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb4-260"><a href="#cb4-260" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"map-tooltip"</span>)</span>
<span id="cb4-261"><a href="#cb4-261" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)<span class="op">;</span></span>
<span id="cb4-262"><a href="#cb4-262" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-263"><a href="#cb4-263" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> mmv <span class="op">=</span> <span class="kw">function</span>(e<span class="op">,</span> d) {</span>
<span id="cb4-264"><a href="#cb4-264" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> [mx<span class="op">,</span> my] <span class="op">=</span> d3<span class="op">.</span><span class="fu">pointer</span>(e)<span class="op">;</span></span>
<span id="cb4-265"><a href="#cb4-265" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> svg_dim <span class="op">=</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">getBoundingClientRect</span>()<span class="op">;</span></span>
<span id="cb4-266"><a href="#cb4-266" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> w_fac <span class="op">=</span> svg_dim<span class="op">.</span><span class="at">width</span><span class="op">/</span>w<span class="op">;</span></span>
<span id="cb4-267"><a href="#cb4-267" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (mx <span class="op">&lt;</span> <span class="dv">50</span><span class="op">/</span>w_fac) mx <span class="op">=</span> <span class="dv">50</span><span class="op">/</span>w_fac<span class="op">;</span></span>
<span id="cb4-268"><a href="#cb4-268" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (mx <span class="op">&gt;</span> w <span class="op">-</span> <span class="dv">190</span><span class="op">/</span>w_fac) mx <span class="op">=</span> w <span class="op">-</span> <span class="dv">190</span><span class="op">/</span>w_fac<span class="op">;</span></span>
<span id="cb4-269"><a href="#cb4-269" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-270"><a href="#cb4-270" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> prob <span class="op">=</span> d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">pr_dem</span><span class="op">;</span></span>
<span id="cb4-271"><a href="#cb4-271" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> cand<span class="op">;</span></span>
<span id="cb4-272"><a href="#cb4-272" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> miss<span class="op">;</span></span>
<span id="cb4-273"><a href="#cb4-273" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (prob <span class="op">&gt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb4-274"><a href="#cb4-274" aria-hidden="true" tabindex="-1"></a>        cand <span class="op">=</span> <span class="op">!</span>d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">dem_cand</span> <span class="op">?</span> <span class="st">"Democrats"</span> <span class="op">:</span> d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">dem_cand</span><span class="op">;</span></span>
<span id="cb4-275"><a href="#cb4-275" aria-hidden="true" tabindex="-1"></a>        miss <span class="op">=</span> <span class="op">!</span>d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">dem_cand</span><span class="op">;</span></span>
<span id="cb4-276"><a href="#cb4-276" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb4-277"><a href="#cb4-277" aria-hidden="true" tabindex="-1"></a>        cand <span class="op">=</span> <span class="op">!</span>d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">rep_cand</span> <span class="op">?</span> <span class="st">"Republicans"</span> <span class="op">:</span> d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">rep_cand</span><span class="op">;</span></span>
<span id="cb4-278"><a href="#cb4-278" aria-hidden="true" tabindex="-1"></a>        miss <span class="op">=</span> <span class="op">!</span>d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">rep_cand</span><span class="op">;</span></span>
<span id="cb4-279"><a href="#cb4-279" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-280"><a href="#cb4-280" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> inc <span class="op">=</span> {</span>
<span id="cb4-281"><a href="#cb4-281" aria-hidden="true" tabindex="-1"></a>        <span class="dt">dem</span><span class="op">:</span> <span class="vs">`&lt;b style='color: </span><span class="sc">${</span>DARK_BLUE<span class="sc">}</span><span class="vs">'&gt;Dem.&lt;/b&gt; incumbent`</span><span class="op">,</span></span>
<span id="cb4-282"><a href="#cb4-282" aria-hidden="true" tabindex="-1"></a>        <span class="dt">gop</span><span class="op">:</span> <span class="vs">`&lt;b style='color: </span><span class="sc">${</span>DARK_RED<span class="sc">}</span><span class="vs">'&gt;Rep.&lt;/b&gt; incumbent`</span><span class="op">,</span></span>
<span id="cb4-283"><a href="#cb4-283" aria-hidden="true" tabindex="-1"></a>        <span class="dt">open</span><span class="op">:</span> <span class="st">"&lt;b&gt;Open&lt;/b&gt; seat"</span><span class="op">,</span></span>
<span id="cb4-284"><a href="#cb4-284" aria-hidden="true" tabindex="-1"></a>    }[d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">inc_seat</span>]</span>
<span id="cb4-285"><a href="#cb4-285" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> prob_text<span class="op">;</span></span>
<span id="cb4-286"><a href="#cb4-286" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> prob_color <span class="op">=</span> prob <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="op">?</span> DARK_BLUE <span class="op">:</span> DARK_RED<span class="op">;</span></span>
<span id="cb4-287"><a href="#cb4-287" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">unopp</span> <span class="op">==</span> <span class="dv">1</span>) {</span>
<span id="cb4-288"><a href="#cb4-288" aria-hidden="true" tabindex="-1"></a>        prob_text <span class="op">=</span> <span class="vs">`&lt;b style="color: </span><span class="sc">${</span>prob_color<span class="sc">}</span><span class="vs">"&gt;</span><span class="sc">${</span>cand<span class="sc">}</span><span class="vs">&lt;/b&gt;</span></span>
<span id="cb4-289"><a href="#cb4-289" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span><span class="sc">${</span>miss <span class="op">?</span> <span class="st">"are"</span> <span class="op">:</span> <span class="st">"is"</span><span class="sc">}</span><span class="vs"> running unopposed and will win the seat.`</span></span>
<span id="cb4-290"><a href="#cb4-290" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb4-291"><a href="#cb4-291" aria-hidden="true" tabindex="-1"></a>        prob_text <span class="op">=</span> <span class="vs">`&lt;b style="color: </span><span class="sc">${</span>prob_color<span class="sc">}</span><span class="vs">"&gt;</span><span class="sc">${</span>cand<span class="sc">}</span><span class="vs">&lt;/b&gt; </span></span>
<span id="cb4-292"><a href="#cb4-292" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span><span class="sc">${</span>miss <span class="op">?</span> <span class="st">"have"</span> <span class="op">:</span> <span class="st">"has"</span><span class="sc">}</span><span class="vs"> a </span></span>
<span id="cb4-293"><a href="#cb4-293" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;b&gt;</span><span class="sc">${</span><span class="fu">fmt_pct</span>(prob <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="op">?</span> prob <span class="op">:</span> <span class="dv">1</span> <span class="op">-</span> prob)<span class="sc">}</span><span class="vs">&lt;/b&gt; chance of winning.`</span></span>
<span id="cb4-294"><a href="#cb4-294" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-295"><a href="#cb4-295" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> disclaimer <span class="op">=</span> d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">rcv</span> <span class="op">?</span> <span class="vs">`&lt;p style="color: #777; font-size: 0.75em; font-style: italic; margin-top: 0.5em;"&gt;</span></span>
<span id="cb4-296"><a href="#cb4-296" aria-hidden="true" tabindex="-1"></a><span class="vs">        Estimates do not account for rank-choice voting.</span></span>
<span id="cb4-297"><a href="#cb4-297" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/p&gt;`</span> <span class="op">:</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb4-298"><a href="#cb4-298" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-299"><a href="#cb4-299" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">2.4</span>)<span class="op">;</span></span>
<span id="cb4-300"><a href="#cb4-300" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-301"><a href="#cb4-301" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> txt <span class="op">=</span> <span class="vs">`&lt;h3&gt;</span><span class="sc">${</span>d<span class="op">.</span><span class="at">match</span><span class="op">.</span><span class="at">name</span><span class="sc">}</span><span class="vs">&lt;/h3&gt;</span></span>
<span id="cb4-302"><a href="#cb4-302" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;p&gt;</span><span class="sc">${</span>inc<span class="sc">}</span><span class="vs">&lt;/p&gt;</span></span>
<span id="cb4-303"><a href="#cb4-303" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;div style="width: 100%; height: 1rem; margin: 4px 0; display: flex;"&gt;</span></span>
<span id="cb4-304"><a href="#cb4-304" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;div style="background: </span><span class="sc">${</span>BLUE<span class="sc">}</span><span class="vs">; flex-basis: </span><span class="sc">${</span><span class="dv">100</span><span class="op">*</span>prob<span class="sc">}</span><span class="vs">%"&gt;&lt;/div&gt;</span></span>
<span id="cb4-305"><a href="#cb4-305" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;div style="background: </span><span class="sc">${</span>RED<span class="sc">}</span><span class="vs">; flex-basis: </span><span class="sc">${</span><span class="dv">100</span> <span class="op">-</span> <span class="dv">100</span><span class="op">*</span>prob<span class="sc">}</span><span class="vs">%"&gt;&lt;/div&gt;</span></span>
<span id="cb4-306"><a href="#cb4-306" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;/div&gt;</span></span>
<span id="cb4-307"><a href="#cb4-307" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;p&gt;</span><span class="sc">${</span>prob_text<span class="sc">}</span><span class="vs">&lt;/p&gt;</span></span>
<span id="cb4-308"><a href="#cb4-308" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">${</span>disclaimer<span class="sc">}</span></span>
<span id="cb4-309"><a href="#cb4-309" aria-hidden="true" tabindex="-1"></a><span class="vs">        `</span><span class="op">;</span></span>
<span id="cb4-310"><a href="#cb4-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-311"><a href="#cb4-311" aria-hidden="true" tabindex="-1"></a>    tt<span class="op">.</span><span class="fu">style</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"visible"</span>)</span>
<span id="cb4-312"><a href="#cb4-312" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">html</span>(txt)</span>
<span id="cb4-313"><a href="#cb4-313" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"left"</span><span class="op">,</span> (mx <span class="op">-</span> <span class="dv">50</span>)<span class="op">*</span>svg_dim<span class="op">.</span><span class="at">width</span><span class="op">/</span>w <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb4-314"><a href="#cb4-314" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"bottom"</span><span class="op">,</span> (h <span class="op">-</span> my <span class="op">+</span> <span class="dv">25</span>)<span class="op">*</span>svg_dim<span class="op">.</span><span class="at">height</span><span class="op">/</span>h <span class="op">+</span> <span class="st">"px"</span>)<span class="op">;</span></span>
<span id="cb4-315"><a href="#cb4-315" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-316"><a href="#cb4-316" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> mout <span class="op">=</span> <span class="kw">function</span>(d) {</span>
<span id="cb4-317"><a href="#cb4-317" aria-hidden="true" tabindex="-1"></a>    geom_distrs_hover<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">0.0</span>)<span class="op">;</span></span>
<span id="cb4-318"><a href="#cb4-318" aria-hidden="true" tabindex="-1"></a>    tt<span class="op">.</span><span class="fu">style</span>(<span class="st">"visibility"</span><span class="op">,</span> <span class="st">"hidden"</span>)<span class="op">;</span></span>
<span id="cb4-319"><a href="#cb4-319" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-320"><a href="#cb4-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-321"><a href="#cb4-321" aria-hidden="true" tabindex="-1"></a>geom_distrs_hover<span class="op">.</span><span class="fu">on</span>(<span class="st">"mousemove"</span><span class="op">,</span> mmv)<span class="op">;</span></span>
<span id="cb4-322"><a href="#cb4-322" aria-hidden="true" tabindex="-1"></a>geom_distrs_hover<span class="op">.</span><span class="fu">on</span>(<span class="st">"touchmove"</span><span class="op">,</span> mmv)<span class="op">;</span></span>
<span id="cb4-323"><a href="#cb4-323" aria-hidden="true" tabindex="-1"></a>svg<span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseout"</span><span class="op">,</span> mout)<span class="op">;</span></span>
<span id="cb4-324"><a href="#cb4-324" aria-hidden="true" tabindex="-1"></a>svg<span class="op">.</span><span class="fu">on</span>(<span class="st">"touchend"</span><span class="op">,</span> mout)<span class="op">;</span></span>
<span id="cb4-325"><a href="#cb4-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-326"><a href="#cb4-326" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb4-327"><a href="#cb4-327" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="plot-map" class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="expression">

</div>
</div>
</div>
</div>
</section>
<section id="gcb" class="level2">
<h2 data-anchor-id="gcb">Public opinion over time</h2>
<p>This chart shows the model’s best estimate of how the generic congressional ballot has evolved over the past few months. The darker and lighter bands show 50% and 80% credible intervals.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="339" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 338;"><span id="cb5-339"><a href="#cb5-339" aria-hidden="true" tabindex="-1"></a>plot_gcb <span class="op">=</span> {</span>
<span id="cb5-340"><a href="#cb5-340" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> d_gcb <span class="op">=</span> <span class="cf">await</span> <span class="fu">FileAttachment</span>(<span class="st">"natl_intent.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({<span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">;</span></span>
<span id="cb5-341"><a href="#cb5-341" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ci_w <span class="op">=</span> d_sum<span class="op">.</span><span class="at">i_q90</span> <span class="op">-</span> d_sum<span class="op">.</span><span class="at">i_q10</span></span>
<span id="cb5-342"><a href="#cb5-342" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ymin <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d_sum<span class="op">.</span><span class="at">i_med</span> <span class="op">-</span> <span class="dv">1</span><span class="op">*</span>ci_w<span class="op">,</span> <span class="fl">0.45</span>)<span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb5-343"><a href="#cb5-343" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ymax <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d_sum<span class="op">.</span><span class="at">i_med</span> <span class="op">+</span> <span class="dv">1</span><span class="op">*</span>ci_w<span class="op">,</span> <span class="fl">0.52</span>)<span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb5-344"><a href="#cb5-344" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> today <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(elec_date<span class="op">,</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>())<span class="op">;</span></span>
<span id="cb5-345"><a href="#cb5-345" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> days_til <span class="op">=</span> (elec_date <span class="op">-</span> today) <span class="op">/</span> (<span class="dv">24</span> <span class="op">*</span> <span class="dv">3600</span> <span class="op">*</span> <span class="dv">1000</span>)<span class="op">;</span></span>
<span id="cb5-346"><a href="#cb5-346" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-347"><a href="#cb5-347" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb5-348"><a href="#cb5-348" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb5-349"><a href="#cb5-349" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb5-350"><a href="#cb5-350" aria-hidden="true" tabindex="-1"></a>            <span class="dt">domain</span><span class="op">:</span> [ymin<span class="op">,</span> ymax]<span class="op">,</span></span>
<span id="cb5-351"><a href="#cb5-351" aria-hidden="true" tabindex="-1"></a>            <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb5-352"><a href="#cb5-352" aria-hidden="true" tabindex="-1"></a>            <span class="dt">tickFormat</span><span class="op">:</span> <span class="st">"%"</span><span class="op">,</span></span>
<span id="cb5-353"><a href="#cb5-353" aria-hidden="true" tabindex="-1"></a>            <span class="dt">axis</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb5-354"><a href="#cb5-354" aria-hidden="true" tabindex="-1"></a>            <span class="dt">ticks</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb5-355"><a href="#cb5-355" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb5-356"><a href="#cb5-356" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="kw">null</span>}<span class="op">,</span></span>
<span id="cb5-357"><a href="#cb5-357" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-358"><a href="#cb5-358" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb5-359"><a href="#cb5-359" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">areaY</span>(d_gcb<span class="op">,</span> {</span>
<span id="cb5-360"><a href="#cb5-360" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span></span>
<span id="cb5-361"><a href="#cb5-361" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y1</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d<span class="op">.</span><span class="at">q10</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="op">,</span></span>
<span id="cb5-362"><a href="#cb5-362" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y2</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d<span class="op">.</span><span class="at">q90</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="op">,</span></span>
<span id="cb5-363"><a href="#cb5-363" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fill</span><span class="op">:</span> BLUE<span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">,</span></span>
<span id="cb5-364"><a href="#cb5-364" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb5-365"><a href="#cb5-365" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">areaY</span>(d_gcb<span class="op">,</span> {</span>
<span id="cb5-366"><a href="#cb5-366" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span></span>
<span id="cb5-367"><a href="#cb5-367" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y1</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d<span class="op">.</span><span class="at">q25</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="op">,</span></span>
<span id="cb5-368"><a href="#cb5-368" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y2</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d<span class="op">.</span><span class="at">q75</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="op">,</span></span>
<span id="cb5-369"><a href="#cb5-369" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fill</span><span class="op">:</span> BLUE<span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">,</span></span>
<span id="cb5-370"><a href="#cb5-370" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb5-371"><a href="#cb5-371" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">areaY</span>(d_gcb<span class="op">,</span> {</span>
<span id="cb5-372"><a href="#cb5-372" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span></span>
<span id="cb5-373"><a href="#cb5-373" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y1</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d<span class="op">.</span><span class="at">q10</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="op">,</span></span>
<span id="cb5-374"><a href="#cb5-374" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y2</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d<span class="op">.</span><span class="at">q90</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="op">,</span></span>
<span id="cb5-375"><a href="#cb5-375" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fill</span><span class="op">:</span> RED<span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">,</span></span>
<span id="cb5-376"><a href="#cb5-376" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb5-377"><a href="#cb5-377" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">areaY</span>(d_gcb<span class="op">,</span> {</span>
<span id="cb5-378"><a href="#cb5-378" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span></span>
<span id="cb5-379"><a href="#cb5-379" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y1</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d<span class="op">.</span><span class="at">q25</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="op">,</span></span>
<span id="cb5-380"><a href="#cb5-380" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y2</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d<span class="op">.</span><span class="at">q75</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="op">,</span></span>
<span id="cb5-381"><a href="#cb5-381" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fill</span><span class="op">:</span> RED<span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">,</span></span>
<span id="cb5-382"><a href="#cb5-382" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb5-383"><a href="#cb5-383" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">line</span>(d_gcb<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">date</span> <span class="op">&lt;=</span> today)<span class="op">,</span> </span>
<span id="cb5-384"><a href="#cb5-384" aria-hidden="true" tabindex="-1"></a>                    {<span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"natl_dem"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span>})<span class="op">,</span></span>
<span id="cb5-385"><a href="#cb5-385" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">line</span>(d_gcb<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">date</span> <span class="op">&gt;=</span> today)<span class="op">,</span> </span>
<span id="cb5-386"><a href="#cb5-386" aria-hidden="true" tabindex="-1"></a>                    {<span class="dt">x</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"natl_dem"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> </span>
<span id="cb5-387"><a href="#cb5-387" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">strokeDasharray</span><span class="op">:</span> <span class="st">"4,3"</span><span class="op">,</span> <span class="dt">strokeLinecap</span><span class="op">:</span> <span class="st">"butt"</span> })<span class="op">,</span></span>
<span id="cb5-388"><a href="#cb5-388" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-389"><a href="#cb5-389" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="fl">0.5</span>]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"#0007"</span>})<span class="op">,</span></span>
<span id="cb5-390"><a href="#cb5-390" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">rect</span>([<span class="dv">0</span>]<span class="op">,</span> {</span>
<span id="cb5-391"><a href="#cb5-391" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x1</span><span class="op">:</span> today<span class="op">,</span> <span class="dt">x2</span><span class="op">:</span> elec_date<span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> ymin<span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> ymax<span class="op">,</span></span>
<span id="cb5-392"><a href="#cb5-392" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fill</span><span class="op">:</span> <span class="st">"#fff7"</span><span class="op">,</span></span>
<span id="cb5-393"><a href="#cb5-393" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb5-394"><a href="#cb5-394" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">ruleX</span>([elec_date<span class="op">,</span> today])<span class="op">,</span></span>
<span id="cb5-395"><a href="#cb5-395" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-396"><a href="#cb5-396" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([SMALL <span class="op">?</span> <span class="st">"Estimated Dem. vote"</span> <span class="op">:</span> <span class="st">"Estimated Democratic two-party vote"</span>]<span class="op">,</span> { </span>
<span id="cb5-397"><a href="#cb5-397" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">min</span>(d_gcb<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">date</span>)<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb5-398"><a href="#cb5-398" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb5-399"><a href="#cb5-399" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span></span>
<span id="cb5-400"><a href="#cb5-400" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb5-401"><a href="#cb5-401" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([days_til <span class="op">&gt;</span> <span class="dv">20</span> <span class="op">+</span> SMALL<span class="op">*</span><span class="dv">30</span> <span class="op">?</span> <span class="st">"TODAY"</span> <span class="op">:</span> <span class="st">""</span>]<span class="op">,</span> { </span>
<span id="cb5-402"><a href="#cb5-402" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> today<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb5-403"><a href="#cb5-403" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"middle"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb5-404"><a href="#cb5-404" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb5-405"><a href="#cb5-405" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb5-406"><a href="#cb5-406" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([<span class="st">"ELECTION DAY"</span>]<span class="op">,</span> { </span>
<span id="cb5-407"><a href="#cb5-407" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> elec_date<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb5-408"><a href="#cb5-408" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"middle"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb5-409"><a href="#cb5-409" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb5-410"><a href="#cb5-410" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb5-411"><a href="#cb5-411" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([<span class="fu">fmt_pct</span>(d_sum<span class="op">.</span><span class="at">i_med</span><span class="op">,</span> <span class="dv">1</span>)]<span class="op">,</span> { </span>
<span id="cb5-412"><a href="#cb5-412" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> elec_date<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> d_sum<span class="op">.</span><span class="at">i_med</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">6</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb5-413"><a href="#cb5-413" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"end"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb5-414"><a href="#cb5-414" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#223"</span><span class="op">,</span></span>
<span id="cb5-415"><a href="#cb5-415" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb5-416"><a href="#cb5-416" aria-hidden="true" tabindex="-1"></a>        ]<span class="op">,</span></span>
<span id="cb5-417"><a href="#cb5-417" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-418"><a href="#cb5-418" aria-hidden="true" tabindex="-1"></a>        <span class="dt">width</span><span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(w_BODY<span class="op">,</span> width)<span class="op">,</span></span>
<span id="cb5-419"><a href="#cb5-419" aria-hidden="true" tabindex="-1"></a>        <span class="dt">height</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span></span>
<span id="cb5-420"><a href="#cb5-420" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marginRight</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb5-421"><a href="#cb5-421" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-422"><a href="#cb5-422" aria-hidden="true" tabindex="-1"></a>        <span class="dt">style</span><span class="op">:</span> {</span>
<span id="cb5-423"><a href="#cb5-423" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-424"><a href="#cb5-424" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb5-425"><a href="#cb5-425" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="plot-gcb" class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="declaration">

</div>
</div>
</div>
</section>
<section id="shifts" class="level2">
<h2 data-anchor-id="shifts">How the national environment affects outcomes</h2>
<p>The chart below shows the range of outcomes we forecast conditional on different national environments. For example, if Democrats win 51% of the vote nationwide, they are expected to eke out a majority on average, but could win anywhere from around 185 to around 250 seats. The colored box covers the middle 50% of possible outcomes, the thick line covers the middle 80% of outcomes, and the thin line covers 98% of outcomes.</p>
<div class="cell" data-include="false">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="438" data-source-offset="-0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 437;"><span id="cb6-438"><a href="#cb6-438" aria-hidden="true" tabindex="-1"></a>d_shift <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"house_shifts.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({<span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb6-439"><a href="#cb6-439" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="at">d_shift</span> <span class="op">=</span> d_shift</span></code></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-6-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-6-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="441" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 440;"><span id="cb7-441"><a href="#cb7-441" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb7-442"><a href="#cb7-442" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb7-443"><a href="#cb7-443" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> [<span class="fl">0.45</span><span class="op">,</span> <span class="fl">0.535</span>]<span class="op">,</span></span>
<span id="cb7-444"><a href="#cb7-444" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tickFormat</span><span class="op">:</span> <span class="st">"%"</span><span class="op">,</span></span>
<span id="cb7-445"><a href="#cb7-445" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"National Democratic vote share"</span><span class="op">,</span></span>
<span id="cb7-446"><a href="#cb7-446" aria-hidden="true" tabindex="-1"></a>        <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-447"><a href="#cb7-447" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb7-448"><a href="#cb7-448" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb7-449"><a href="#cb7-449" aria-hidden="true" tabindex="-1"></a>        <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-450"><a href="#cb7-450" aria-hidden="true" tabindex="-1"></a>        <span class="dt">line</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-451"><a href="#cb7-451" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domain</span><span class="op">:</span> [<span class="dv">150</span><span class="op">,</span> <span class="dv">270</span>]<span class="op">,</span></span>
<span id="cb7-452"><a href="#cb7-452" aria-hidden="true" tabindex="-1"></a>        <span class="dt">label</span><span class="op">:</span> <span class="st">"Democratic seats won"</span><span class="op">,</span></span>
<span id="cb7-453"><a href="#cb7-453" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb7-454"><a href="#cb7-454" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb7-455"><a href="#cb7-455" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="fl">217.5</span>]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"#0007"</span>})<span class="op">,</span></span>
<span id="cb7-456"><a href="#cb7-456" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="fl">0.50</span>]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"#0004"</span>})<span class="op">,</span></span>
<span id="cb7-457"><a href="#cb7-457" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">ruleX</span>(d_shift<span class="op">,</span> {</span>
<span id="cb7-458"><a href="#cb7-458" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="st">"natl"</span><span class="op">,</span></span>
<span id="cb7-459"><a href="#cb7-459" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y1</span><span class="op">:</span> <span class="st">"q01"</span><span class="op">,</span> </span>
<span id="cb7-460"><a href="#cb7-460" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y2</span><span class="op">:</span> <span class="st">"q99"</span><span class="op">,</span></span>
<span id="cb7-461"><a href="#cb7-461" aria-hidden="true" tabindex="-1"></a>            <span class="dt">strokeWidth</span><span class="op">:</span> <span class="fl">1.4</span><span class="op">,</span></span>
<span id="cb7-462"><a href="#cb7-462" aria-hidden="true" tabindex="-1"></a>            <span class="dt">clip</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-463"><a href="#cb7-463" aria-hidden="true" tabindex="-1"></a>        })<span class="op">,</span></span>
<span id="cb7-464"><a href="#cb7-464" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">ruleX</span>(d_shift<span class="op">,</span> {</span>
<span id="cb7-465"><a href="#cb7-465" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="st">"natl"</span><span class="op">,</span></span>
<span id="cb7-466"><a href="#cb7-466" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y</span><span class="op">:</span> <span class="st">"q10"</span><span class="op">,</span> </span>
<span id="cb7-467"><a href="#cb7-467" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y2</span><span class="op">:</span> <span class="st">"q90"</span><span class="op">,</span></span>
<span id="cb7-468"><a href="#cb7-468" aria-hidden="true" tabindex="-1"></a>            <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb7-469"><a href="#cb7-469" aria-hidden="true" tabindex="-1"></a>            <span class="dt">clip</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-470"><a href="#cb7-470" aria-hidden="true" tabindex="-1"></a>        })<span class="op">,</span></span>
<span id="cb7-471"><a href="#cb7-471" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">rect</span>(d_shift<span class="op">,</span> {</span>
<span id="cb7-472"><a href="#cb7-472" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x1</span><span class="op">:</span> x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">natl</span> <span class="op">-</span> <span class="fl">0.002</span><span class="op">,</span> </span>
<span id="cb7-473"><a href="#cb7-473" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x2</span><span class="op">:</span> x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">natl</span> <span class="op">+</span> <span class="fl">0.002</span><span class="op">,</span> </span>
<span id="cb7-474"><a href="#cb7-474" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y1</span><span class="op">:</span> <span class="st">"q25"</span><span class="op">,</span> </span>
<span id="cb7-475"><a href="#cb7-475" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y2</span><span class="op">:</span> <span class="st">"q75"</span><span class="op">,</span></span>
<span id="cb7-476"><a href="#cb7-476" aria-hidden="true" tabindex="-1"></a>            <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb7-477"><a href="#cb7-477" aria-hidden="true" tabindex="-1"></a>            <span class="dt">strokeWidth</span><span class="op">:</span> <span class="fl">0.8</span><span class="op">,</span></span>
<span id="cb7-478"><a href="#cb7-478" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fill</span><span class="op">:</span> x <span class="kw">=&gt;</span> <span class="fu">color</span>(x<span class="op">.</span><span class="at">pr_win</span>)<span class="op">,</span></span>
<span id="cb7-479"><a href="#cb7-479" aria-hidden="true" tabindex="-1"></a>            <span class="dt">clip</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-480"><a href="#cb7-480" aria-hidden="true" tabindex="-1"></a>        })<span class="op">,</span></span>
<span id="cb7-481"><a href="#cb7-481" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">text</span>([<span class="st">"Majority"</span>]<span class="op">,</span> { </span>
<span id="cb7-482"><a href="#cb7-482" aria-hidden="true" tabindex="-1"></a>                <span class="dt">y</span><span class="op">:</span> <span class="dv">218</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">2</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb7-483"><a href="#cb7-483" aria-hidden="true" tabindex="-1"></a>                <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"left"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb7-484"><a href="#cb7-484" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb7-485"><a href="#cb7-485" aria-hidden="true" tabindex="-1"></a>        () <span class="kw">=&gt;</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb7-486"><a href="#cb7-486" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb7-487"><a href="#cb7-487" aria-hidden="true" tabindex="-1"></a>                <span class="dt">domain</span><span class="op">:</span> [<span class="fl">0.45</span><span class="op">,</span> <span class="fl">0.535</span>]<span class="op">,</span></span>
<span id="cb7-488"><a href="#cb7-488" aria-hidden="true" tabindex="-1"></a>                <span class="dt">axis</span><span class="op">:</span> <span class="kw">null</span></span>
<span id="cb7-489"><a href="#cb7-489" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb7-490"><a href="#cb7-490" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb7-491"><a href="#cb7-491" aria-hidden="true" tabindex="-1"></a>                <span class="dt">grid</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb7-492"><a href="#cb7-492" aria-hidden="true" tabindex="-1"></a>                <span class="dt">domain</span><span class="op">:</span> [<span class="dv">150</span> <span class="op">-</span> <span class="dv">222</span><span class="op">,</span> <span class="dv">270</span> <span class="op">-</span> <span class="dv">222</span>]<span class="op">,</span></span>
<span id="cb7-493"><a href="#cb7-493" aria-hidden="true" tabindex="-1"></a>                <span class="dt">transform</span><span class="op">:</span> x <span class="kw">=&gt;</span> x <span class="op">-</span> <span class="dv">222</span><span class="op">,</span></span>
<span id="cb7-494"><a href="#cb7-494" aria-hidden="true" tabindex="-1"></a>                <span class="dt">axis</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span> </span>
<span id="cb7-495"><a href="#cb7-495" aria-hidden="true" tabindex="-1"></a>                <span class="dt">line</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-496"><a href="#cb7-496" aria-hidden="true" tabindex="-1"></a>                <span class="dt">tickSize</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb7-497"><a href="#cb7-497" aria-hidden="true" tabindex="-1"></a>                <span class="dt">tickFormat</span><span class="op">:</span> x <span class="kw">=&gt;</span> (x <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> <span class="st">"+"</span> <span class="op">:</span> <span class="st">""</span>) <span class="op">+</span> x<span class="op">,</span></span>
<span id="cb7-498"><a href="#cb7-498" aria-hidden="true" tabindex="-1"></a>                <span class="dt">label</span><span class="op">:</span> <span class="st">"Seats gained or lost"</span><span class="op">,</span></span>
<span id="cb7-499"><a href="#cb7-499" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb7-500"><a href="#cb7-500" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb7-501"><a href="#cb7-501" aria-hidden="true" tabindex="-1"></a>                Plot<span class="op">.</span><span class="fu">ruleY</span>(d_shift<span class="op">,</span> {</span>
<span id="cb7-502"><a href="#cb7-502" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x1</span><span class="op">:</span> x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">natl</span> <span class="op">-</span> <span class="fl">0.002</span><span class="op">,</span> </span>
<span id="cb7-503"><a href="#cb7-503" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x2</span><span class="op">:</span> x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">natl</span> <span class="op">+</span> <span class="fl">0.002</span><span class="op">,</span> </span>
<span id="cb7-504"><a href="#cb7-504" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y</span><span class="op">:</span> <span class="st">"q50"</span><span class="op">,</span> </span>
<span id="cb7-505"><a href="#cb7-505" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb7-506"><a href="#cb7-506" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">clip</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-507"><a href="#cb7-507" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb7-508"><a href="#cb7-508" aria-hidden="true" tabindex="-1"></a>            ]<span class="op">,</span></span>
<span id="cb7-509"><a href="#cb7-509" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-510"><a href="#cb7-510" aria-hidden="true" tabindex="-1"></a>            <span class="dt">width</span><span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(w_BODY<span class="op">,</span> width)<span class="op">,</span></span>
<span id="cb7-511"><a href="#cb7-511" aria-hidden="true" tabindex="-1"></a>            <span class="dt">height</span><span class="op">:</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb7-512"><a href="#cb7-512" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb7-513"><a href="#cb7-513" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marginRight</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb7-514"><a href="#cb7-514" aria-hidden="true" tabindex="-1"></a>            <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb7-515"><a href="#cb7-515" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb7-516"><a href="#cb7-516" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb7-517"><a href="#cb7-517" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-518"><a href="#cb7-518" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(w_BODY<span class="op">,</span> width)<span class="op">,</span></span>
<span id="cb7-519"><a href="#cb7-519" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb7-520"><a href="#cb7-520" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginRight</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb7-521"><a href="#cb7-521" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb7-522"><a href="#cb7-522" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb7-523"><a href="#cb7-523" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-524"><a href="#cb7-524" aria-hidden="true" tabindex="-1"></a>    <span class="dt">style</span><span class="op">:</span> {</span>
<span id="cb7-525"><a href="#cb7-525" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-526"><a href="#cb7-526" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="expression">

</div>
</div>
</div>
</section>
<section id="table" class="level2">
<h2 data-anchor-id="table">The 435 House races</h2>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="534" data-source-offset="-0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 533;"><span id="cb8-534"><a href="#cb8-534" aria-hidden="true" tabindex="-1"></a>viewof search <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">search</span>(d_distr_list<span class="op">,</span> {</span>
<span id="cb8-535"><a href="#cb8-535" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Districts:"</span><span class="op">,</span></span>
<span id="cb8-536"><a href="#cb8-536" aria-hidden="true" tabindex="-1"></a>    <span class="dt">columns</span><span class="op">:</span> [<span class="st">"name"</span><span class="op">,</span> <span class="st">"state"</span><span class="op">,</span> <span class="st">"inc_seat"</span><span class="op">,</span> <span class="st">"search"</span><span class="op">,</span> <span class="st">"rating"</span><span class="op">,</span> <span class="st">"dem_cand"</span><span class="op">,</span> <span class="st">"rep_cand"</span>]<span class="op">,</span></span>
<span id="cb8-537"><a href="#cb8-537" aria-hidden="true" tabindex="-1"></a>    <span class="dt">autocomplete</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb8-538"><a href="#cb8-538" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(width <span class="op">-</span> <span class="dv">8</span><span class="op">,</span> w_BODY)<span class="op">,</span></span>
<span id="cb8-539"><a href="#cb8-539" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-540"><a href="#cb8-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-541"><a href="#cb8-541" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`Democrats are expected to win **</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">sum</span>(tab_distr<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">pr_dem</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">1</span>)<span class="sc">}</span></span>
<span id="cb8-542"><a href="#cb8-542" aria-hidden="true" tabindex="-1"></a><span class="vs">of the </span><span class="sc">${</span>tab_distr<span class="op">.</span><span class="at">length</span><span class="sc">}</span><span class="vs">** districts selected below, on average.`</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-8-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p class="text-muted">
You can search by district state, number, candidate, incumbency, rating, or contestedness. Try searching for “Pelosi”, “WA 7,” “open,” “safe,” “contested,” “lean rep.,” or “tossup” seats.
</p>
<div id="distr-tab" class="cell">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="552" data-source-offset="-0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 551;"><span id="cb9-552"><a href="#cb9-552" aria-hidden="true" tabindex="-1"></a>viewof tab_distr <span class="op">=</span> {</span>
<span id="cb9-553"><a href="#cb9-553" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> fmt_name <span class="op">=</span> <span class="kw">function</span>(x) {</span>
<span id="cb9-554"><a href="#cb9-554" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;span style="font-weight: 500; font-size: </span><span class="sc">${</span>small <span class="op">?</span> <span class="fl">0.85</span> <span class="op">:</span> <span class="fl">1.0</span><span class="sc">}</span><span class="vs">em;"&gt;</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span></span>
<span id="cb9-555"><a href="#cb9-555" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-556"><a href="#cb9-556" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> fmt_inc <span class="op">=</span> <span class="kw">function</span>(x) {</span>
<span id="cb9-557"><a href="#cb9-557" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;span class="inc" style="color: </span><span class="sc">${</span>{<span class="dt">dem</span><span class="op">:</span> DARK_BLUE<span class="op">,</span> <span class="dt">gop</span><span class="op">:</span> DARK_RED<span class="op">,</span> <span class="dt">open</span><span class="op">:</span> <span class="st">"black"</span>}[x]<span class="sc">}</span><span class="vs">"&gt;</span></span>
<span id="cb9-558"><a href="#cb9-558" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span><span class="sc">${</span>{<span class="dt">dem</span><span class="op">:</span> <span class="st">"Dem."</span><span class="op">,</span> <span class="dt">gop</span><span class="op">:</span> <span class="st">"Rep."</span><span class="op">,</span> <span class="dt">open</span><span class="op">:</span> <span class="st">"Open"</span>}[x]<span class="sc">}</span></span>
<span id="cb9-559"><a href="#cb9-559" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;/span&gt;`</span></span>
<span id="cb9-560"><a href="#cb9-560" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-561"><a href="#cb9-561" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> fmt_part <span class="op">=</span> <span class="kw">function</span>(x) {</span>
<span id="cb9-562"><a href="#cb9-562" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (x <span class="op">===</span> <span class="kw">null</span>) {</span>
<span id="cb9-563"><a href="#cb9-563" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;span style="color: #777"&gt;&amp;ndash;&lt;/span&gt;`</span></span>
<span id="cb9-564"><a href="#cb9-564" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb9-565"><a href="#cb9-565" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> color <span class="op">=</span> x <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="op">?</span> DARK_BLUE <span class="op">:</span> DARK_RED<span class="op">;</span></span>
<span id="cb9-566"><a href="#cb9-566" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;span style="color: </span><span class="sc">${</span>color<span class="sc">}</span><span class="vs">"&gt;</span><span class="sc">${</span><span class="fu">fmt_pct</span>(x<span class="op">,</span> <span class="dv">1</span>)<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span></span>
<span id="cb9-567"><a href="#cb9-567" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb9-568"><a href="#cb9-568" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-569"><a href="#cb9-569" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> fmt_prob <span class="op">=</span> <span class="kw">function</span>(x) {</span>
<span id="cb9-570"><a href="#cb9-570" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> tcolor <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(x <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">&gt;</span> <span class="fl">0.3</span> <span class="op">?</span> <span class="st">"#fffc"</span> <span class="op">:</span> <span class="st">"black"</span><span class="op">;</span></span>
<span id="cb9-571"><a href="#cb9-571" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;div class="chip" style="background: </span><span class="sc">${</span><span class="fu">color</span>(x)<span class="sc">}</span><span class="vs">; color: </span><span class="sc">${</span>tcolor<span class="sc">}</span><span class="vs">"&gt;</span></span>
<span id="cb9-572"><a href="#cb9-572" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span><span class="sc">${</span><span class="fu">fmt_pct</span>(x)<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb9-573"><a href="#cb9-573" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-574"><a href="#cb9-574" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-575"><a href="#cb9-575" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> xmin <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(d_distr_list<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">dem_q10</span>)</span>
<span id="cb9-576"><a href="#cb9-576" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> xmax <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d_distr_list<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">dem_q90</span>)</span>
<span id="cb9-577"><a href="#cb9-577" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> avg <span class="op">=</span> <span class="dv">50</span><span class="op">*</span>(xmin <span class="op">+</span> xmax)<span class="op">;</span></span>
<span id="cb9-578"><a href="#cb9-578" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()<span class="op">.</span><span class="fu">domain</span>([xmax<span class="op">,</span> xmin])<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])<span class="op">;</span></span>
<span id="cb9-579"><a href="#cb9-579" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> x_dem <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()<span class="op">.</span><span class="fu">domain</span>([xmax<span class="op">,</span> <span class="fl">0.5</span>])<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> avg])<span class="op">.</span><span class="fu">clamp</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb9-580"><a href="#cb9-580" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> x_rep <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()<span class="op">.</span><span class="fu">domain</span>([<span class="fl">0.5</span><span class="op">,</span> xmin])<span class="op">.</span><span class="fu">range</span>([avg<span class="op">,</span> <span class="dv">100</span>])<span class="op">.</span><span class="fu">clamp</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb9-581"><a href="#cb9-581" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> ici_d <span class="op">=</span> BLUE <span class="op">+</span> <span class="st">"bb"</span><span class="op">;</span></span>
<span id="cb9-582"><a href="#cb9-582" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> oci_d <span class="op">=</span> BLUE <span class="op">+</span> <span class="st">"77"</span><span class="op">;</span></span>
<span id="cb9-583"><a href="#cb9-583" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> ici_r <span class="op">=</span> RED <span class="op">+</span> <span class="st">"cc"</span><span class="op">;</span></span>
<span id="cb9-584"><a href="#cb9-584" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> oci_r <span class="op">=</span> RED <span class="op">+</span> <span class="st">"88"</span><span class="op">;</span></span>
<span id="cb9-585"><a href="#cb9-585" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> fmt_vs <span class="op">=</span> <span class="kw">function</span>(int) {</span>
<span id="cb9-586"><a href="#cb9-586" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (int[<span class="dv">0</span>] <span class="op">===</span> <span class="kw">null</span>) {</span>
<span id="cb9-587"><a href="#cb9-587" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;div style="text-align: center; color: #777; font-size: 0.85em;"&gt;(Unopposed)&lt;/div&gt;`</span></span>
<span id="cb9-588"><a href="#cb9-588" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb9-589"><a href="#cb9-589" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> gr <span class="op">=</span> <span class="vs">`linear-gradient(90deg, transparent 0%,</span></span>
<span id="cb9-590"><a href="#cb9-590" aria-hidden="true" tabindex="-1"></a><span class="vs">               transparent </span><span class="sc">${</span><span class="fu">x_dem</span>(int[<span class="dv">4</span>])<span class="sc">}</span><span class="vs">%, </span><span class="sc">${</span>oci_d<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span><span class="fu">x_dem</span>(int[<span class="dv">4</span>])<span class="sc">}</span><span class="vs">%, </span></span>
<span id="cb9-591"><a href="#cb9-591" aria-hidden="true" tabindex="-1"></a><span class="vs">               </span><span class="sc">${</span>oci_d<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span><span class="fu">x_dem</span>(int[<span class="dv">3</span>])<span class="sc">}</span><span class="vs">%, </span><span class="sc">${</span>ici_d<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span><span class="fu">x_dem</span>(int[<span class="dv">3</span>])<span class="sc">}</span><span class="vs">%,</span></span>
<span id="cb9-592"><a href="#cb9-592" aria-hidden="true" tabindex="-1"></a><span class="vs">               </span><span class="sc">${</span>ici_d<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span><span class="fu">x_dem</span>(int[<span class="dv">2</span>])<span class="sc">}</span><span class="vs">%, </span><span class="sc">${</span>oci_d<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span><span class="fu">x_dem</span>(int[<span class="dv">2</span>])<span class="sc">}</span><span class="vs">%,</span></span>
<span id="cb9-593"><a href="#cb9-593" aria-hidden="true" tabindex="-1"></a><span class="vs">               </span><span class="sc">${</span>oci_d<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span><span class="fu">x_dem</span>(int[<span class="dv">1</span>])<span class="sc">}</span><span class="vs">%, transparent </span><span class="sc">${</span><span class="fu">x_dem</span>(int[<span class="dv">1</span>])<span class="sc">}</span><span class="vs">%,</span></span>
<span id="cb9-594"><a href="#cb9-594" aria-hidden="true" tabindex="-1"></a><span class="vs">               transparent </span><span class="sc">${</span><span class="fu">x_rep</span>(int[<span class="dv">4</span>])<span class="sc">}</span><span class="vs">%,  </span><span class="sc">${</span>oci_r<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span><span class="fu">x_rep</span>(int[<span class="dv">4</span>])<span class="sc">}</span><span class="vs">%, </span></span>
<span id="cb9-595"><a href="#cb9-595" aria-hidden="true" tabindex="-1"></a><span class="vs">               </span><span class="sc">${</span>oci_r<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span><span class="fu">x_rep</span>(int[<span class="dv">3</span>])<span class="sc">}</span><span class="vs">%, </span><span class="sc">${</span>ici_r<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span><span class="fu">x_rep</span>(int[<span class="dv">3</span>])<span class="sc">}</span><span class="vs">%,</span></span>
<span id="cb9-596"><a href="#cb9-596" aria-hidden="true" tabindex="-1"></a><span class="vs">               </span><span class="sc">${</span>ici_r<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span><span class="fu">x_rep</span>(int[<span class="dv">2</span>])<span class="sc">}</span><span class="vs">%, </span><span class="sc">${</span>oci_r<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span><span class="fu">x_rep</span>(int[<span class="dv">2</span>])<span class="sc">}</span><span class="vs">%,</span></span>
<span id="cb9-597"><a href="#cb9-597" aria-hidden="true" tabindex="-1"></a><span class="vs">               </span><span class="sc">${</span>oci_r<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span><span class="fu">x_rep</span>(int[<span class="dv">1</span>])<span class="sc">}</span><span class="vs">%, transparent </span><span class="sc">${</span><span class="fu">x_rep</span>(int[<span class="dv">1</span>])<span class="sc">}</span><span class="vs">%,</span></span>
<span id="cb9-598"><a href="#cb9-598" aria-hidden="true" tabindex="-1"></a><span class="vs">               transparent 100%)`</span><span class="op">;</span></span>
<span id="cb9-599"><a href="#cb9-599" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> disclaimer <span class="op">=</span> int[<span class="dv">5</span>] <span class="op">?</span> <span class="st">"&amp;dagger;"</span> <span class="op">:</span> <span class="st">""</span><span class="op">;</span> <span class="co">// RCV</span></span>
<span id="cb9-600"><a href="#cb9-600" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="fu">html</span><span class="vs">`</span></span>
<span id="cb9-601"><a href="#cb9-601" aria-hidden="true" tabindex="-1"></a><span class="vs">                &lt;div class="est" style="background: </span><span class="sc">${</span>gr<span class="sc">}</span><span class="vs">; </span></span>
<span id="cb9-602"><a href="#cb9-602" aria-hidden="true" tabindex="-1"></a><span class="vs">                    padding-left: calc(</span><span class="sc">${</span><span class="fu">x</span>(int[<span class="dv">0</span>])<span class="sc">}</span><span class="vs">% - 6px);"&gt;</span></span>
<span id="cb9-603"><a href="#cb9-603" aria-hidden="true" tabindex="-1"></a><span class="vs">                &amp;#x25cf;&amp;nbsp;</span><span class="sc">${</span><span class="fu">fmt_pct</span>(int[<span class="dv">0</span>])<span class="sc">}${</span>disclaimer<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb9-604"><a href="#cb9-604" aria-hidden="true" tabindex="-1"></a><span class="vs">                `</span><span class="op">;</span></span>
<span id="cb9-605"><a href="#cb9-605" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb9-606"><a href="#cb9-606" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-607"><a href="#cb9-607" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> fmt_vs_tiny <span class="op">=</span> <span class="kw">function</span>(int) {</span>
<span id="cb9-608"><a href="#cb9-608" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (int[<span class="dv">0</span>] <span class="op">===</span> <span class="kw">null</span>) {</span>
<span id="cb9-609"><a href="#cb9-609" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;span style="color: #777; font-size: 0.85em;"&gt;(Unopp.)&lt;/span&gt;`</span></span>
<span id="cb9-610"><a href="#cb9-610" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb9-611"><a href="#cb9-611" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> color <span class="op">=</span> int[<span class="dv">0</span>] <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="op">?</span> DARK_BLUE <span class="op">:</span> DARK_RED<span class="op">;</span></span>
<span id="cb9-612"><a href="#cb9-612" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> disclaimer <span class="op">=</span> int[<span class="dv">5</span>] <span class="op">?</span> <span class="st">"&amp;dagger;"</span> <span class="op">:</span> <span class="st">""</span><span class="op">;</span> <span class="co">// RCV</span></span>
<span id="cb9-613"><a href="#cb9-613" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;span style="color: </span><span class="sc">${</span>color<span class="sc">}</span><span class="vs">;"&gt;</span><span class="sc">${</span><span class="fu">fmt_pct</span>(int[<span class="dv">0</span>]<span class="op">,</span> <span class="dv">1</span>)<span class="sc">}${</span>disclaimer<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb9-614"><a href="#cb9-614" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb9-615"><a href="#cb9-615" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-616"><a href="#cb9-616" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-617"><a href="#cb9-617" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> fmt_cands <span class="op">=</span> <span class="kw">function</span>(x) {</span>
<span id="cb9-618"><a href="#cb9-618" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> na_html <span class="op">=</span> <span class="st">"&lt;span style='color: #777'&gt;&amp;ndash;&lt;/span&gt;"</span><span class="op">;</span></span>
<span id="cb9-619"><a href="#cb9-619" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> d_cand <span class="op">=</span> x[<span class="dv">0</span>] <span class="op">===</span> <span class="kw">null</span> <span class="op">?</span> na_html <span class="op">:</span> x[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb9-620"><a href="#cb9-620" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> r_cand <span class="op">=</span> x[<span class="dv">1</span>] <span class="op">===</span> <span class="kw">null</span> <span class="op">?</span> na_html <span class="op">:</span> x[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb9-621"><a href="#cb9-621" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (SMALL) {</span>
<span id="cb9-622"><a href="#cb9-622" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (x[<span class="dv">2</span>] <span class="op">==</span> <span class="st">"dem"</span>) { <span class="co">// incumbent</span></span>
<span id="cb9-623"><a href="#cb9-623" aria-hidden="true" tabindex="-1"></a>                d_cand <span class="op">+=</span> <span class="st">"*"</span></span>
<span id="cb9-624"><a href="#cb9-624" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">else</span> <span class="cf">if</span> (x[<span class="dv">2</span>] <span class="op">==</span> <span class="st">"rep"</span>) {</span>
<span id="cb9-625"><a href="#cb9-625" aria-hidden="true" tabindex="-1"></a>                r_cand <span class="op">+=</span> <span class="st">"*"</span></span>
<span id="cb9-626"><a href="#cb9-626" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb9-627"><a href="#cb9-627" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb9-628"><a href="#cb9-628" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;div class="ddem cand"&gt;</span><span class="sc">${</span>d_cand<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb9-629"><a href="#cb9-629" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;div class="drep cand"&gt;</span><span class="sc">${</span>r_cand<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb9-630"><a href="#cb9-630" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-631"><a href="#cb9-631" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-632"><a href="#cb9-632" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> cols <span class="op">=</span> [<span class="st">"margin"</span><span class="op">,</span> <span class="st">"name_short"</span><span class="op">,</span> <span class="st">"cands"</span><span class="op">,</span> <span class="st">"inc_seat"</span><span class="op">,</span> <span class="st">"pr_dem"</span><span class="op">,</span> <span class="st">"interval"</span><span class="op">,</span> <span class="st">"part_base"</span><span class="op">,</span> ]<span class="op">;</span></span>
<span id="cb9-633"><a href="#cb9-633" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> cols_small <span class="op">=</span> [<span class="st">"margin"</span><span class="op">,</span> <span class="st">"name_short"</span><span class="op">,</span> <span class="st">"cands"</span><span class="op">,</span> <span class="st">"pr_dem"</span><span class="op">,</span> <span class="st">"interval"</span><span class="op">,</span> <span class="st">"part_base"</span><span class="op">,</span> ]<span class="op">;</span></span>
<span id="cb9-634"><a href="#cb9-634" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> cols_tiny <span class="op">=</span> [<span class="st">"margin"</span><span class="op">,</span> <span class="st">"name_short"</span><span class="op">,</span> <span class="st">"cands"</span><span class="op">,</span> <span class="st">"pr_dem"</span><span class="op">,</span> <span class="st">"interval"</span><span class="op">,</span> ]<span class="op">;</span></span>
<span id="cb9-635"><a href="#cb9-635" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> tiny <span class="op">=</span> width <span class="op">&lt;</span> <span class="dv">496</span><span class="op">;</span></span>
<span id="cb9-636"><a href="#cb9-636" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> small <span class="op">=</span> width <span class="op">&lt;</span> <span class="dv">650</span></span>
<span id="cb9-637"><a href="#cb9-637" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-638"><a href="#cb9-638" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">table</span>(search<span class="op">,</span> {</span>
<span id="cb9-639"><a href="#cb9-639" aria-hidden="true" tabindex="-1"></a>        <span class="dt">columns</span><span class="op">:</span> small <span class="op">?</span> (tiny <span class="op">?</span> cols_tiny <span class="op">:</span> cols_small) <span class="op">:</span> cols<span class="op">,</span></span>
<span id="cb9-640"><a href="#cb9-640" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-641"><a href="#cb9-641" aria-hidden="true" tabindex="-1"></a>        <span class="dt">header</span><span class="op">:</span> {</span>
<span id="cb9-642"><a href="#cb9-642" aria-hidden="true" tabindex="-1"></a>            <span class="dt">name_short</span><span class="op">:</span> small <span class="op">?</span> <span class="st">"Distr."</span> <span class="op">:</span> <span class="st">"District"</span><span class="op">,</span></span>
<span id="cb9-643"><a href="#cb9-643" aria-hidden="true" tabindex="-1"></a>            <span class="dt">inc_seat</span><span class="op">:</span> <span class="st">"Inc."</span><span class="op">,</span></span>
<span id="cb9-644"><a href="#cb9-644" aria-hidden="true" tabindex="-1"></a>            <span class="dt">cands</span><span class="op">:</span> <span class="st">"Candidates"</span><span class="op">,</span></span>
<span id="cb9-645"><a href="#cb9-645" aria-hidden="true" tabindex="-1"></a>            <span class="dt">pr_dem</span><span class="op">:</span> small <span class="op">?</span> <span class="st">"Prob."</span> <span class="op">:</span> <span class="st">"Dem. prob."</span><span class="op">,</span></span>
<span id="cb9-646"><a href="#cb9-646" aria-hidden="true" tabindex="-1"></a>            <span class="dt">interval</span><span class="op">:</span> small <span class="op">?</span> <span class="st">"Est. vote"</span> <span class="op">:</span> <span class="st">"Vote forecast"</span><span class="op">,</span></span>
<span id="cb9-647"><a href="#cb9-647" aria-hidden="true" tabindex="-1"></a>            <span class="dt">part_base</span><span class="op">:</span> small <span class="op">?</span> <span class="st">"Lean"</span> <span class="op">:</span> <span class="st">"Part. Lean"</span><span class="op">,</span></span>
<span id="cb9-648"><a href="#cb9-648" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb9-649"><a href="#cb9-649" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-650"><a href="#cb9-650" aria-hidden="true" tabindex="-1"></a>        <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb9-651"><a href="#cb9-651" aria-hidden="true" tabindex="-1"></a>            <span class="dt">name_short</span><span class="op">:</span> fmt_name<span class="op">,</span></span>
<span id="cb9-652"><a href="#cb9-652" aria-hidden="true" tabindex="-1"></a>            <span class="dt">inc_seat</span><span class="op">:</span> fmt_inc<span class="op">,</span></span>
<span id="cb9-653"><a href="#cb9-653" aria-hidden="true" tabindex="-1"></a>            <span class="dt">pr_dem</span><span class="op">:</span> fmt_prob<span class="op">,</span></span>
<span id="cb9-654"><a href="#cb9-654" aria-hidden="true" tabindex="-1"></a>            <span class="dt">cands</span><span class="op">:</span> fmt_cands<span class="op">,</span></span>
<span id="cb9-655"><a href="#cb9-655" aria-hidden="true" tabindex="-1"></a>            <span class="dt">interval</span><span class="op">:</span> tiny <span class="op">?</span> fmt_vs_tiny <span class="op">:</span> fmt_vs<span class="op">,</span></span>
<span id="cb9-656"><a href="#cb9-656" aria-hidden="true" tabindex="-1"></a>            <span class="dt">part_base</span><span class="op">:</span> fmt_part<span class="op">,</span></span>
<span id="cb9-657"><a href="#cb9-657" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb9-658"><a href="#cb9-658" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-659"><a href="#cb9-659" aria-hidden="true" tabindex="-1"></a>        <span class="dt">sort</span><span class="op">:</span> <span class="st">"margin"</span><span class="op">,</span></span>
<span id="cb9-660"><a href="#cb9-660" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-661"><a href="#cb9-661" aria-hidden="true" tabindex="-1"></a>        <span class="dt">width</span><span class="op">:</span> {</span>
<span id="cb9-662"><a href="#cb9-662" aria-hidden="true" tabindex="-1"></a>            <span class="dt">interval</span><span class="op">:</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb9-663"><a href="#cb9-663" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb9-664"><a href="#cb9-664" aria-hidden="true" tabindex="-1"></a>        <span class="dt">maxWidth</span><span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(w_BODY<span class="op">,</span> width)<span class="op">,</span></span>
<span id="cb9-665"><a href="#cb9-665" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-666"><a href="#cb9-666" aria-hidden="true" tabindex="-1"></a>        <span class="dt">rows</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb9-667"><a href="#cb9-667" aria-hidden="true" tabindex="-1"></a>        <span class="dt">layout</span><span class="op">:</span> <span class="st">"fixed"</span><span class="op">,</span></span>
<span id="cb9-668"><a href="#cb9-668" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb9-669"><a href="#cb9-669" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-670"><a href="#cb9-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-671"><a href="#cb9-671" aria-hidden="true" tabindex="-1"></a>SMALL <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;small style="color: #777"&gt;*Incumbent candidate&lt;/small&gt;`</span> <span class="op">:</span> <span class="fu">html</span><span class="vs">``</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="distr-tab-1">
<div id="ojs-cell-9-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="distr-tab-2">
<div id="ojs-cell-9-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<p><small style="color: #777">†Estimates do not account for rank-choice voting.</small></p>
</section>
<section id="history" class="level2">
<h2 data-anchor-id="history">How the odds have changed</h2>
<p>The model is regularly re-run as new data and polls come in. The charts below track how the model’s election-day forecast has changed over time.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="683" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 682;"><span id="cb10-683"><a href="#cb10-683" aria-hidden="true" tabindex="-1"></a>plot_prob <span class="op">=</span> {</span>
<span id="cb10-684"><a href="#cb10-684" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> today <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d_history<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">from_date</span>)<span class="op">;</span></span>
<span id="cb10-685"><a href="#cb10-685" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> days_til <span class="op">=</span> (elec_date <span class="op">-</span> today) <span class="op">/</span> (<span class="dv">24</span> <span class="op">*</span> <span class="dv">3600</span> <span class="op">*</span> <span class="dv">1000</span>)<span class="op">;</span></span>
<span id="cb10-686"><a href="#cb10-686" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-687"><a href="#cb10-687" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb10-688"><a href="#cb10-688" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb10-689"><a href="#cb10-689" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb10-690"><a href="#cb10-690" aria-hidden="true" tabindex="-1"></a>            <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb10-691"><a href="#cb10-691" aria-hidden="true" tabindex="-1"></a>            <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb10-692"><a href="#cb10-692" aria-hidden="true" tabindex="-1"></a>            <span class="dt">tickFormat</span><span class="op">:</span> <span class="st">"%"</span><span class="op">,</span></span>
<span id="cb10-693"><a href="#cb10-693" aria-hidden="true" tabindex="-1"></a>            <span class="dt">axis</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb10-694"><a href="#cb10-694" aria-hidden="true" tabindex="-1"></a>            <span class="dt">ticks</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="fl">0.25</span><span class="op">,</span> <span class="fl">0.5</span><span class="op">,</span> <span class="fl">0.75</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb10-695"><a href="#cb10-695" aria-hidden="true" tabindex="-1"></a>            <span class="dt">insetTop</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb10-696"><a href="#cb10-696" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb10-697"><a href="#cb10-697" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="kw">null</span>}<span class="op">,</span></span>
<span id="cb10-698"><a href="#cb10-698" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-699"><a href="#cb10-699" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb10-700"><a href="#cb10-700" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">line</span>(d_history<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"from_date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"house_prob"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> BLUE})<span class="op">,</span></span>
<span id="cb10-701"><a href="#cb10-701" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">line</span>(d_history<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"from_date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="dv">1</span> <span class="op">-</span> d<span class="op">.</span><span class="at">house_prob</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> RED})<span class="op">,</span></span>
<span id="cb10-702"><a href="#cb10-702" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-703"><a href="#cb10-703" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="fl">0.5</span>]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"#0007"</span>})<span class="op">,</span></span>
<span id="cb10-704"><a href="#cb10-704" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">ruleX</span>([elec_date<span class="op">,</span> today])<span class="op">,</span></span>
<span id="cb10-705"><a href="#cb10-705" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-706"><a href="#cb10-706" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([<span class="st">"Odds of winning House"</span>]<span class="op">,</span> { </span>
<span id="cb10-707"><a href="#cb10-707" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">min</span>(d_history<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">from_date</span>)<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb10-708"><a href="#cb10-708" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb10-709"><a href="#cb10-709" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span></span>
<span id="cb10-710"><a href="#cb10-710" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb10-711"><a href="#cb10-711" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([days_til <span class="op">&gt;</span> <span class="dv">20</span> <span class="op">+</span> SMALL<span class="op">*</span><span class="dv">30</span> <span class="op">?</span> <span class="st">"TODAY"</span> <span class="op">:</span> <span class="st">""</span>]<span class="op">,</span> { </span>
<span id="cb10-712"><a href="#cb10-712" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> today<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb10-713"><a href="#cb10-713" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"middle"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb10-714"><a href="#cb10-714" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb10-715"><a href="#cb10-715" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb10-716"><a href="#cb10-716" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([<span class="st">"ELECTION DAY"</span>]<span class="op">,</span> { </span>
<span id="cb10-717"><a href="#cb10-717" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> elec_date<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb10-718"><a href="#cb10-718" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"middle"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb10-719"><a href="#cb10-719" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb10-720"><a href="#cb10-720" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb10-721"><a href="#cb10-721" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([<span class="fu">fmt_pct</span>(d_sum<span class="op">.</span><span class="at">house_prob</span>)]<span class="op">,</span> { </span>
<span id="cb10-722"><a href="#cb10-722" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> today<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> d_sum<span class="op">.</span><span class="at">house_prob</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">6</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb10-723"><a href="#cb10-723" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> </span>
<span id="cb10-724"><a href="#cb10-724" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> BLUE<span class="op">,</span> </span>
<span id="cb10-725"><a href="#cb10-725" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">stroke</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb10-726"><a href="#cb10-726" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb10-727"><a href="#cb10-727" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([<span class="fu">fmt_pct</span>(<span class="dv">1</span> <span class="op">-</span> d_sum<span class="op">.</span><span class="at">house_prob</span>)]<span class="op">,</span> { </span>
<span id="cb10-728"><a href="#cb10-728" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> today<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">1</span> <span class="op">-</span> d_sum<span class="op">.</span><span class="at">house_prob</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">6</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb10-729"><a href="#cb10-729" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> </span>
<span id="cb10-730"><a href="#cb10-730" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> RED<span class="op">,</span></span>
<span id="cb10-731"><a href="#cb10-731" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">stroke</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb10-732"><a href="#cb10-732" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb10-733"><a href="#cb10-733" aria-hidden="true" tabindex="-1"></a>        ]<span class="op">,</span></span>
<span id="cb10-734"><a href="#cb10-734" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-735"><a href="#cb10-735" aria-hidden="true" tabindex="-1"></a>        <span class="dt">width</span><span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">768</span> <span class="op">?</span> width <span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(w_BODY<span class="op">,</span> width) <span class="op">*</span> <span class="fl">0.48</span><span class="op">,</span></span>
<span id="cb10-736"><a href="#cb10-736" aria-hidden="true" tabindex="-1"></a>        <span class="dt">height</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span></span>
<span id="cb10-737"><a href="#cb10-737" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marginRight</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb10-738"><a href="#cb10-738" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb10-739"><a href="#cb10-739" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb10-740"><a href="#cb10-740" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="plot-prob" class="cell-output cell-output-display">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="745" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 744;"><span id="cb11-745"><a href="#cb11-745" aria-hidden="true" tabindex="-1"></a>plot_gcb_prob <span class="op">=</span> {</span>
<span id="cb11-746"><a href="#cb11-746" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> today <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d_history<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">from_date</span>)<span class="op">;</span></span>
<span id="cb11-747"><a href="#cb11-747" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> days_til <span class="op">=</span> (elec_date <span class="op">-</span> today) <span class="op">/</span> (<span class="dv">24</span> <span class="op">*</span> <span class="dv">3600</span> <span class="op">*</span> <span class="dv">1000</span>)<span class="op">;</span></span>
<span id="cb11-748"><a href="#cb11-748" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-749"><a href="#cb11-749" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb11-750"><a href="#cb11-750" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb11-751"><a href="#cb11-751" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb11-752"><a href="#cb11-752" aria-hidden="true" tabindex="-1"></a>            <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb11-753"><a href="#cb11-753" aria-hidden="true" tabindex="-1"></a>            <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb11-754"><a href="#cb11-754" aria-hidden="true" tabindex="-1"></a>            <span class="dt">tickFormat</span><span class="op">:</span> <span class="st">"%"</span><span class="op">,</span></span>
<span id="cb11-755"><a href="#cb11-755" aria-hidden="true" tabindex="-1"></a>            <span class="dt">axis</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb11-756"><a href="#cb11-756" aria-hidden="true" tabindex="-1"></a>            <span class="dt">ticks</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="fl">0.25</span><span class="op">,</span> <span class="fl">0.5</span><span class="op">,</span> <span class="fl">0.75</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb11-757"><a href="#cb11-757" aria-hidden="true" tabindex="-1"></a>            <span class="dt">insetTop</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb11-758"><a href="#cb11-758" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb11-759"><a href="#cb11-759" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="kw">null</span>}<span class="op">,</span></span>
<span id="cb11-760"><a href="#cb11-760" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-761"><a href="#cb11-761" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb11-762"><a href="#cb11-762" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">line</span>(d_history<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"from_date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"i_prob"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> BLUE})<span class="op">,</span></span>
<span id="cb11-763"><a href="#cb11-763" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">line</span>(d_history<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"from_date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="dv">1</span> <span class="op">-</span> d<span class="op">.</span><span class="at">i_prob</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> RED})<span class="op">,</span></span>
<span id="cb11-764"><a href="#cb11-764" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-765"><a href="#cb11-765" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="fl">0.5</span>]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"#0007"</span>})<span class="op">,</span></span>
<span id="cb11-766"><a href="#cb11-766" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">ruleX</span>([elec_date<span class="op">,</span> today])<span class="op">,</span></span>
<span id="cb11-767"><a href="#cb11-767" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-768"><a href="#cb11-768" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([<span class="st">"Odds of winning pop. vote"</span>]<span class="op">,</span> { </span>
<span id="cb11-769"><a href="#cb11-769" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">min</span>(d_history<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">from_date</span>)<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb11-770"><a href="#cb11-770" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb11-771"><a href="#cb11-771" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span></span>
<span id="cb11-772"><a href="#cb11-772" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb11-773"><a href="#cb11-773" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([days_til <span class="op">&gt;</span> <span class="dv">20</span> <span class="op">+</span> SMALL<span class="op">*</span><span class="dv">30</span> <span class="op">?</span> <span class="st">"TODAY"</span> <span class="op">:</span> <span class="st">""</span>]<span class="op">,</span> { </span>
<span id="cb11-774"><a href="#cb11-774" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> today<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb11-775"><a href="#cb11-775" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"middle"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb11-776"><a href="#cb11-776" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb11-777"><a href="#cb11-777" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb11-778"><a href="#cb11-778" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([<span class="st">"ELECTION DAY"</span>]<span class="op">,</span> { </span>
<span id="cb11-779"><a href="#cb11-779" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> elec_date<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb11-780"><a href="#cb11-780" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"middle"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb11-781"><a href="#cb11-781" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb11-782"><a href="#cb11-782" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb11-783"><a href="#cb11-783" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([<span class="fu">fmt_pct</span>(d_sum<span class="op">.</span><span class="at">i_prob</span>)]<span class="op">,</span> { </span>
<span id="cb11-784"><a href="#cb11-784" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> today<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> d_sum<span class="op">.</span><span class="at">i_prob</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">6</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb11-785"><a href="#cb11-785" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> </span>
<span id="cb11-786"><a href="#cb11-786" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> BLUE<span class="op">,</span> </span>
<span id="cb11-787"><a href="#cb11-787" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">stroke</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb11-788"><a href="#cb11-788" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb11-789"><a href="#cb11-789" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([<span class="fu">fmt_pct</span>(<span class="dv">1</span> <span class="op">-</span> d_sum<span class="op">.</span><span class="at">i_prob</span>)]<span class="op">,</span> { </span>
<span id="cb11-790"><a href="#cb11-790" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> today<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">1</span> <span class="op">-</span> d_sum<span class="op">.</span><span class="at">i_prob</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">6</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb11-791"><a href="#cb11-791" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> </span>
<span id="cb11-792"><a href="#cb11-792" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> RED<span class="op">,</span></span>
<span id="cb11-793"><a href="#cb11-793" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">stroke</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb11-794"><a href="#cb11-794" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb11-795"><a href="#cb11-795" aria-hidden="true" tabindex="-1"></a>        ]<span class="op">,</span></span>
<span id="cb11-796"><a href="#cb11-796" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-797"><a href="#cb11-797" aria-hidden="true" tabindex="-1"></a>        <span class="dt">width</span><span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">768</span> <span class="op">?</span> width <span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(w_BODY<span class="op">,</span> width) <span class="op">*</span> <span class="fl">0.48</span><span class="op">,</span></span>
<span id="cb11-798"><a href="#cb11-798" aria-hidden="true" tabindex="-1"></a>        <span class="dt">height</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span></span>
<span id="cb11-799"><a href="#cb11-799" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marginRight</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb11-800"><a href="#cb11-800" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb11-801"><a href="#cb11-801" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb11-802"><a href="#cb11-802" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="plot-gcb-prob" class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="809" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 808;"><span id="cb12-809"><a href="#cb12-809" aria-hidden="true" tabindex="-1"></a>plot_hist_seats <span class="op">=</span> {</span>
<span id="cb12-810"><a href="#cb12-810" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> today <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d_history<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">from_date</span>)<span class="op">;</span></span>
<span id="cb12-811"><a href="#cb12-811" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> days_til <span class="op">=</span> (elec_date <span class="op">-</span> today) <span class="op">/</span> (<span class="dv">24</span> <span class="op">*</span> <span class="dv">3600</span> <span class="op">*</span> <span class="dv">1000</span>)<span class="op">;</span></span>
<span id="cb12-812"><a href="#cb12-812" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ymin <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(d_history<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">house_q10</span>) <span class="op">*</span> <span class="fl">0.9</span><span class="op">;</span></span>
<span id="cb12-813"><a href="#cb12-813" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ymax <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(d_history<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">house_q90</span>) <span class="op">/</span> <span class="fl">0.9</span><span class="op">;</span></span>
<span id="cb12-814"><a href="#cb12-814" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-815"><a href="#cb12-815" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb12-816"><a href="#cb12-816" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb12-817"><a href="#cb12-817" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb12-818"><a href="#cb12-818" aria-hidden="true" tabindex="-1"></a>            <span class="dt">domain</span><span class="op">:</span> [ymin<span class="op">,</span> ymax]<span class="op">,</span></span>
<span id="cb12-819"><a href="#cb12-819" aria-hidden="true" tabindex="-1"></a>            <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb12-820"><a href="#cb12-820" aria-hidden="true" tabindex="-1"></a>            <span class="dt">axis</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb12-821"><a href="#cb12-821" aria-hidden="true" tabindex="-1"></a>            <span class="dt">ticks</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb12-822"><a href="#cb12-822" aria-hidden="true" tabindex="-1"></a>            <span class="dt">insetTop</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb12-823"><a href="#cb12-823" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb12-824"><a href="#cb12-824" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="kw">null</span>}<span class="op">,</span></span>
<span id="cb12-825"><a href="#cb12-825" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-826"><a href="#cb12-826" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb12-827"><a href="#cb12-827" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">areaY</span>(d_history<span class="op">,</span> {</span>
<span id="cb12-828"><a href="#cb12-828" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> <span class="st">"from_date"</span><span class="op">,</span></span>
<span id="cb12-829"><a href="#cb12-829" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y1</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d<span class="op">.</span><span class="at">house_q10</span><span class="op">,</span> <span class="fl">217.5</span>)<span class="op">,</span></span>
<span id="cb12-830"><a href="#cb12-830" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y2</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d<span class="op">.</span><span class="at">house_q90</span><span class="op">,</span> <span class="fl">217.5</span>)<span class="op">,</span></span>
<span id="cb12-831"><a href="#cb12-831" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fill</span><span class="op">:</span> BLUE<span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">,</span></span>
<span id="cb12-832"><a href="#cb12-832" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb12-833"><a href="#cb12-833" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">areaY</span>(d_history<span class="op">,</span> {</span>
<span id="cb12-834"><a href="#cb12-834" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> <span class="st">"from_date"</span><span class="op">,</span></span>
<span id="cb12-835"><a href="#cb12-835" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y1</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d<span class="op">.</span><span class="at">house_q25</span><span class="op">,</span> <span class="fl">217.5</span>)<span class="op">,</span></span>
<span id="cb12-836"><a href="#cb12-836" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y2</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(d<span class="op">.</span><span class="at">house_q75</span><span class="op">,</span> <span class="fl">217.5</span>)<span class="op">,</span></span>
<span id="cb12-837"><a href="#cb12-837" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fill</span><span class="op">:</span> BLUE<span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">,</span></span>
<span id="cb12-838"><a href="#cb12-838" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb12-839"><a href="#cb12-839" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">areaY</span>(d_history<span class="op">,</span> {</span>
<span id="cb12-840"><a href="#cb12-840" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> <span class="st">"from_date"</span><span class="op">,</span></span>
<span id="cb12-841"><a href="#cb12-841" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y1</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d<span class="op">.</span><span class="at">house_q10</span><span class="op">,</span> <span class="fl">217.5</span>)<span class="op">,</span></span>
<span id="cb12-842"><a href="#cb12-842" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y2</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d<span class="op">.</span><span class="at">house_q90</span><span class="op">,</span> <span class="fl">217.5</span>)<span class="op">,</span></span>
<span id="cb12-843"><a href="#cb12-843" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fill</span><span class="op">:</span> RED<span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">,</span></span>
<span id="cb12-844"><a href="#cb12-844" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb12-845"><a href="#cb12-845" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">areaY</span>(d_history<span class="op">,</span> {</span>
<span id="cb12-846"><a href="#cb12-846" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> <span class="st">"from_date"</span><span class="op">,</span></span>
<span id="cb12-847"><a href="#cb12-847" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y1</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d<span class="op">.</span><span class="at">house_q25</span><span class="op">,</span> <span class="fl">217.5</span>)<span class="op">,</span></span>
<span id="cb12-848"><a href="#cb12-848" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">y2</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(d<span class="op">.</span><span class="at">house_q75</span><span class="op">,</span> <span class="fl">217.5</span>)<span class="op">,</span></span>
<span id="cb12-849"><a href="#cb12-849" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fill</span><span class="op">:</span> RED<span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">,</span></span>
<span id="cb12-850"><a href="#cb12-850" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb12-851"><a href="#cb12-851" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">line</span>(d_history<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"from_date"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"house_med"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">3</span>})<span class="op">,</span></span>
<span id="cb12-852"><a href="#cb12-852" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-853"><a href="#cb12-853" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="fl">217.5</span>]<span class="op">,</span> {<span class="dt">stroke</span><span class="op">:</span> <span class="st">"#0007"</span>})<span class="op">,</span></span>
<span id="cb12-854"><a href="#cb12-854" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">ruleX</span>([elec_date<span class="op">,</span> today])<span class="op">,</span></span>
<span id="cb12-855"><a href="#cb12-855" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-856"><a href="#cb12-856" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([SMALL <span class="op">?</span> <span class="st">"Forecasted Dem. seats"</span> <span class="op">:</span> <span class="st">"Forecasted Democratic seats won"</span>]<span class="op">,</span> { </span>
<span id="cb12-857"><a href="#cb12-857" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">min</span>(d_history<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">from_date</span>)<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb12-858"><a href="#cb12-858" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb12-859"><a href="#cb12-859" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span></span>
<span id="cb12-860"><a href="#cb12-860" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb12-861"><a href="#cb12-861" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([days_til <span class="op">&gt;</span> <span class="dv">20</span> <span class="op">+</span> SMALL<span class="op">*</span><span class="dv">30</span> <span class="op">?</span> <span class="st">"TODAY"</span> <span class="op">:</span> <span class="st">""</span>]<span class="op">,</span> { </span>
<span id="cb12-862"><a href="#cb12-862" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> today<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb12-863"><a href="#cb12-863" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"middle"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb12-864"><a href="#cb12-864" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb12-865"><a href="#cb12-865" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb12-866"><a href="#cb12-866" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([<span class="st">"ELECTION DAY"</span>]<span class="op">,</span> { </span>
<span id="cb12-867"><a href="#cb12-867" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> elec_date<span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb12-868"><a href="#cb12-868" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"middle"</span><span class="op">,</span> <span class="dt">lineAnchor</span><span class="op">:</span> <span class="st">"bottom"</span><span class="op">,</span></span>
<span id="cb12-869"><a href="#cb12-869" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb12-870"><a href="#cb12-870" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb12-871"><a href="#cb12-871" aria-hidden="true" tabindex="-1"></a>            Plot<span class="op">.</span><span class="fu">text</span>([d_sum<span class="op">.</span><span class="at">house_med</span>]<span class="op">,</span> { </span>
<span id="cb12-872"><a href="#cb12-872" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> today<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> d_sum<span class="op">.</span><span class="at">house_med</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">6</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb12-873"><a href="#cb12-873" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">frameAnchor</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> </span>
<span id="cb12-874"><a href="#cb12-874" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#223"</span><span class="op">,</span></span>
<span id="cb12-875"><a href="#cb12-875" aria-hidden="true" tabindex="-1"></a>                })<span class="op">,</span></span>
<span id="cb12-876"><a href="#cb12-876" aria-hidden="true" tabindex="-1"></a>        ]<span class="op">,</span></span>
<span id="cb12-877"><a href="#cb12-877" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-878"><a href="#cb12-878" aria-hidden="true" tabindex="-1"></a>        <span class="dt">width</span><span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(w_BODY<span class="op">,</span> width)<span class="op">,</span></span>
<span id="cb12-879"><a href="#cb12-879" aria-hidden="true" tabindex="-1"></a>        <span class="dt">height</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span></span>
<span id="cb12-880"><a href="#cb12-880" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marginRight</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb12-881"><a href="#cb12-881" aria-hidden="true" tabindex="-1"></a>        <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb12-882"><a href="#cb12-882" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-883"><a href="#cb12-883" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="plot-hist-seats" class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
</section>
<section id="polls" class="level1">
<h1>National polling</h1>
<p>The most recent generic congressional ballot polls are shown in the table below. The <b>Impact</b> column roughly measures how the poll is currently affecting the model—whether it is pulling the forecast towards Democrats or Republicans, and by how much.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="894" data-source-offset="0"><pre class="sourceCode js"><code class="sourceCode javascript" style="counter-reset: source-line 893;"><span id="cb13-894"><a href="#cb13-894" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb13-895"><a href="#cb13-895" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> d_polls <span class="op">=</span> <span class="cf">await</span> <span class="fu">FileAttachment</span>(<span class="st">"polls.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({<span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">;</span></span>
<span id="cb13-896"><a href="#cb13-896" aria-hidden="true" tabindex="-1"></a>    d_polls <span class="op">=</span> d_polls<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> {</span>
<span id="cb13-897"><a href="#cb13-897" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">lv_type</span> <span class="op">=</span> [d<span class="op">.</span><span class="at">lv</span><span class="op">,</span> d<span class="op">.</span><span class="at">type</span>]<span class="op">;</span></span>
<span id="cb13-898"><a href="#cb13-898" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb13-899"><a href="#cb13-899" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb13-900"><a href="#cb13-900" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-901"><a href="#cb13-901" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> fmt_firm <span class="op">=</span> x <span class="kw">=&gt;</span> <span class="fu">html</span><span class="vs">`&lt;div class="firm"&gt;</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb13-902"><a href="#cb13-902" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> fmt_date <span class="op">=</span> x <span class="kw">=&gt;</span> <span class="fu">html</span><span class="vs">`&lt;span class="date"&gt;</span><span class="sc">${</span>x<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"en-US"</span><span class="op">,</span> { <span class="dt">month</span><span class="op">:</span> <span class="st">'short'</span><span class="op">,</span> <span class="dt">day</span><span class="op">:</span> <span class="st">'numeric'</span> })<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb13-903"><a href="#cb13-903" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> fmt_type <span class="op">=</span> <span class="kw">function</span>(x) {</span>
<span id="cb13-904"><a href="#cb13-904" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> type <span class="op">=</span> x[<span class="dv">1</span>] <span class="op">==</span> <span class="st">"unknown"</span> <span class="op">?</span> <span class="st">"&amp;ndash;"</span> <span class="op">:</span> x[<span class="dv">1</span>]<span class="op">.</span><span class="fu">toUpperCase</span>()<span class="op">;</span></span>
<span id="cb13-905"><a href="#cb13-905" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> lv <span class="op">=</span> x[<span class="dv">0</span>] <span class="op">==</span> <span class="dv">1</span> <span class="op">?</span> <span class="st">"LV"</span> <span class="op">:</span> <span class="st">"RV/Adults"</span><span class="op">;</span></span>
<span id="cb13-906"><a href="#cb13-906" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;div class="poll-type"&gt;</span><span class="sc">${</span>type<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb13-907"><a href="#cb13-907" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;div class="poll-lv"&gt;</span><span class="sc">${</span>lv<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb13-908"><a href="#cb13-908" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-909"><a href="#cb13-909" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> fmt_bias <span class="op">=</span> <span class="kw">function</span>(x) {</span>
<span id="cb13-910"><a href="#cb13-910" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> color <span class="op">=</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="op">?</span> DARK_BLUE <span class="op">:</span> DARK_RED<span class="op">;</span></span>
<span id="cb13-911"><a href="#cb13-911" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> prefix <span class="op">=</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="op">?</span> <span class="st">"D"</span> <span class="op">:</span> <span class="st">"R"</span><span class="op">;</span></span>
<span id="cb13-912"><a href="#cb13-912" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;span style="color: </span><span class="sc">${</span>color<span class="sc">}</span><span class="vs">; font-size: </span><span class="sc">${</span>SMALL <span class="op">?</span> <span class="fl">0.75</span> <span class="op">:</span> <span class="fl">0.9</span><span class="sc">}</span><span class="vs">em;"&gt;</span></span>
<span id="cb13-913"><a href="#cb13-913" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span><span class="sc">${</span>prefix<span class="sc">}</span><span class="vs">+</span><span class="sc">${</span>(<span class="dv">100</span><span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(x))<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">1</span>)<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb13-914"><a href="#cb13-914" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-915"><a href="#cb13-915" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> fmt_est <span class="op">=</span> <span class="kw">function</span>(x) {</span>
<span id="cb13-916"><a href="#cb13-916" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;div class="chip" style="background: </span><span class="sc">${</span><span class="fu">color</span>(<span class="dv">5</span><span class="op">*</span>x<span class="op">-</span><span class="dv">2</span>)<span class="sc">}</span><span class="vs">;"&gt;</span></span>
<span id="cb13-917"><a href="#cb13-917" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span><span class="sc">${</span><span class="fu">fmt_pct</span>(x<span class="op">,</span> <span class="dv">1</span>)<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb13-918"><a href="#cb13-918" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-919"><a href="#cb13-919" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> fmt_impact <span class="op">=</span> <span class="kw">function</span>(x) {</span>
<span id="cb13-920"><a href="#cb13-920" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> tcolor <span class="op">=</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="op">?</span> <span class="st">"#006381"</span> <span class="op">:</span> <span class="st">"#80442C"</span><span class="op">;</span></span>
<span id="cb13-921"><a href="#cb13-921" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> prefix <span class="op">=</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="op">?</span> <span class="st">"D"</span> <span class="op">:</span> <span class="st">"R"</span><span class="op">;</span></span>
<span id="cb13-922"><a href="#cb13-922" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;div class="chip" style="background: </span><span class="sc">${</span><span class="fu">color</span>(<span class="fl">0.5</span><span class="op">+</span>x)<span class="sc">}</span><span class="vs">; color: </span><span class="sc">${</span>tcolor<span class="sc">}</span><span class="vs">;"&gt;</span></span>
<span id="cb13-923"><a href="#cb13-923" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span><span class="sc">${</span>prefix<span class="sc">}</span><span class="vs">+</span><span class="sc">${</span><span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(x)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb13-924"><a href="#cb13-924" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-925"><a href="#cb13-925" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-926"><a href="#cb13-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-927"><a href="#cb13-927" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> cols <span class="op">=</span> [<span class="st">"date"</span><span class="op">,</span> <span class="st">"firm"</span><span class="op">,</span> <span class="st">"firm_bias"</span><span class="op">,</span> <span class="st">"lv_type"</span><span class="op">,</span> <span class="st">"est"</span><span class="op">,</span> <span class="st">"impact"</span>]<span class="op">;</span></span>
<span id="cb13-928"><a href="#cb13-928" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> cols_small <span class="op">=</span> [<span class="st">"date"</span><span class="op">,</span> <span class="st">"firm"</span><span class="op">,</span> <span class="st">"firm_bias"</span><span class="op">,</span> <span class="st">"est"</span><span class="op">,</span> <span class="st">"impact"</span>]<span class="op">;</span></span>
<span id="cb13-929"><a href="#cb13-929" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-930"><a href="#cb13-930" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">table</span>(d_polls<span class="op">,</span> {</span>
<span id="cb13-931"><a href="#cb13-931" aria-hidden="true" tabindex="-1"></a>        <span class="dt">columns</span><span class="op">:</span> SMALL <span class="op">?</span> cols_small <span class="op">:</span> cols<span class="op">,</span></span>
<span id="cb13-932"><a href="#cb13-932" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-933"><a href="#cb13-933" aria-hidden="true" tabindex="-1"></a>        <span class="dt">header</span><span class="op">:</span> {</span>
<span id="cb13-934"><a href="#cb13-934" aria-hidden="true" tabindex="-1"></a>            <span class="dt">date</span><span class="op">:</span> <span class="st">"Date"</span><span class="op">,</span></span>
<span id="cb13-935"><a href="#cb13-935" aria-hidden="true" tabindex="-1"></a>            <span class="dt">firm</span><span class="op">:</span> SMALL <span class="op">?</span> <span class="st">"Firm"</span> <span class="op">:</span> <span class="st">"Polling firm"</span><span class="op">,</span></span>
<span id="cb13-936"><a href="#cb13-936" aria-hidden="true" tabindex="-1"></a>            <span class="dt">firm_bias</span><span class="op">:</span> SMALL <span class="op">?</span> <span class="st">"Bias"</span> <span class="op">:</span> <span class="st">"Firm bias"</span><span class="op">,</span></span>
<span id="cb13-937"><a href="#cb13-937" aria-hidden="true" tabindex="-1"></a>            <span class="dt">lv_type</span><span class="op">:</span> <span class="st">"Poll type"</span><span class="op">,</span></span>
<span id="cb13-938"><a href="#cb13-938" aria-hidden="true" tabindex="-1"></a>            <span class="dt">est</span><span class="op">:</span> SMALL <span class="op">?</span> <span class="st">"Result"</span> <span class="op">:</span> <span class="st">"Poll result"</span><span class="op">,</span></span>
<span id="cb13-939"><a href="#cb13-939" aria-hidden="true" tabindex="-1"></a>            <span class="dt">impact</span><span class="op">:</span> <span class="st">"Impact"</span><span class="op">,</span></span>
<span id="cb13-940"><a href="#cb13-940" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb13-941"><a href="#cb13-941" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-942"><a href="#cb13-942" aria-hidden="true" tabindex="-1"></a>        <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb13-943"><a href="#cb13-943" aria-hidden="true" tabindex="-1"></a>            <span class="dt">date</span><span class="op">:</span> fmt_date<span class="op">,</span></span>
<span id="cb13-944"><a href="#cb13-944" aria-hidden="true" tabindex="-1"></a>            <span class="dt">firm</span><span class="op">:</span> fmt_firm<span class="op">,</span></span>
<span id="cb13-945"><a href="#cb13-945" aria-hidden="true" tabindex="-1"></a>            <span class="dt">firm_bias</span><span class="op">:</span> fmt_bias<span class="op">,</span></span>
<span id="cb13-946"><a href="#cb13-946" aria-hidden="true" tabindex="-1"></a>            <span class="dt">lv_type</span><span class="op">:</span> fmt_type<span class="op">,</span></span>
<span id="cb13-947"><a href="#cb13-947" aria-hidden="true" tabindex="-1"></a>            <span class="dt">est</span><span class="op">:</span> fmt_est<span class="op">,</span></span>
<span id="cb13-948"><a href="#cb13-948" aria-hidden="true" tabindex="-1"></a>            <span class="dt">impact</span><span class="op">:</span> fmt_impact<span class="op">,</span></span>
<span id="cb13-949"><a href="#cb13-949" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb13-950"><a href="#cb13-950" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-951"><a href="#cb13-951" aria-hidden="true" tabindex="-1"></a>        <span class="dt">width</span><span class="op">:</span> {</span>
<span id="cb13-952"><a href="#cb13-952" aria-hidden="true" tabindex="-1"></a>            <span class="dt">firm</span><span class="op">:</span> SMALL <span class="op">?</span> <span class="dv">120</span> <span class="op">:</span> <span class="dv">350</span><span class="op">,</span></span>
<span id="cb13-953"><a href="#cb13-953" aria-hidden="true" tabindex="-1"></a>            <span class="dt">impact</span><span class="op">:</span> SMALL <span class="op">?</span> <span class="dv">50</span> <span class="op">:</span> <span class="dv">80</span><span class="op">,</span></span>
<span id="cb13-954"><a href="#cb13-954" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb13-955"><a href="#cb13-955" aria-hidden="true" tabindex="-1"></a>        <span class="dt">maxWidth</span><span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(w_BODY<span class="op">,</span> width)<span class="op">,</span></span>
<span id="cb13-956"><a href="#cb13-956" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-957"><a href="#cb13-957" aria-hidden="true" tabindex="-1"></a>        <span class="dt">rows</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span></span>
<span id="cb13-958"><a href="#cb13-958" aria-hidden="true" tabindex="-1"></a>        <span class="dt">layout</span><span class="op">:</span> <span class="st">"fixed"</span><span class="op">,</span></span>
<span id="cb13-959"><a href="#cb13-959" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb13-960"><a href="#cb13-960" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="polls-tab" class="cell-output cell-output-display">
<div id="ojs-cell-13" data-nodetype="expression">

</div>
</div>
</div>
<hr style="margin: 2em 0">
<p class="text-muted">
<small> 50% and 80% credible intervals are presented throughout. </small>
</p>
<p class="text-muted">
<small> A detailed write-up of the model, along with code and data, are available <a href="https://github.com/CoryMcCartan/midterms-22" target="_blank">here</a>. </small>
</p>
<p class="text-muted">
<small> Data are courtesy of FiveThirtyEight, Data for Progress, VEST, the ALARM Project, Daily Kos Elections, the MIT Election Data + Science Lab, and IPUMS. </small>
</p>
<svg height="10" width="10" xmlns="http://www.w3.org/2000/svg" version="1.1">
<defs> <pattern id="diagonalHatch" width="3" height="3" patterntransform="rotate(45 0 0)" patternunits="userSpaceOnUse"> <line x1="0" y1="0" x2="0" y2="3" style="stroke: #0105; stroke-width: 3;"></line> </pattern> </defs>
</svg>
<script type="text/javascript">
const params = new Proxy(new URLSearchParams(window.location.search), {
    get: (searchParams, prop) => searchParams.get(prop),
});
if (params.embedded == "true") {
    document.getElementById("quarto-header").remove();
    document.getElementById("title-block-header").remove();
    let css = `@media (max-width: 767.98px) { body .page-columns, body.fullcontent:not(.floating):not(.docked) .page-columns, body.slimcontent:not(.floating):not(.docked) .page-columns, body.docked .page-columns, body.docked.slimcontent .page-columns, body.docked.fullcontent .page-columns, body.floating .page-columns, body.floating.slimcontent .page-columns, body.floating.fullcontent .page-columns {
        grid-template-columns: [screen-start] 0em [screen-start-inset page-start page-start-inset body-start-outset body-start body-content-start] minmax(0px, 1fr) [body-content-end body-end body-end-outset page-end-inset page-end screen-end-inset] 0em [screen-end];}}
    .banner { background: linear-gradient(90deg, white 0%, #f0f2f6 15%, #f0f2f6 85%, white 100%) !important; }`;
    let style = document.createElement("style");
    style.type = "text/css";
    style.appendChild(document.createTextNode(css));
    document.head.appendChild(style);
    setTimeout(() => window.scrollTo(0, 0), 300);
}
</script>


</section>

</main> <!-- /main -->

<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"import { fmt_pct, rate, fmt_surname, AP } from \"./utils.js\"\nd3 = require(\"d3\")\n\nd_sum = FileAttachment(\"summary.json\").json()\ngeom_hex = FileAttachment(\"hex.json\").json()\nd_history = FileAttachment(\"history.csv\").csv({typed: true})\nd_hist = FileAttachment(\"seats_hist_house.csv\").csv({typed: true})\nd_distr_list = {\n    let raw = await FileAttachment(\"house_districts.csv\").csv({typed: true});\n    return raw.map(d => {\n        let at_large = [\"AK\", \"DE\", \"ND\", \"SD\", \"VT\", \"WY\"].includes(d.state);\n        d.name = AP[d.state] + \" \" + (at_large ? \"At-Large\" : d.district);\n        d.name_short = AP[d.state] +  (at_large ? \"\" : \" \" + d.district);\n        d.rcv = [\"AK\", \"ME\"].includes(d.state);\n        d.interval = [d.dem_mean, d.dem_q10, d.dem_q25, d.dem_q75, d.dem_q90, d.rcv];\n        d.rating = rate(d.pr_dem);\n        d.margin = Math.abs(d.dem_mean - 0.5);\n        d.dem_cand = fmt_surname(d.dem_cand);\n        d.rep_cand = fmt_surname(d.rep_cand);\n        if (d.state == \"AK\") {\n            d.dem_cand = null;\n            d.rep_cand = null;\n        }\n        d.cands = [d.dem_cand, d.rep_cand, d.inc_seat];\n        d.search = {dem: \"incumbent dem. \", open: \"open seat \", gop: \"incumbent rep. incumbent gop. \"}[d.inc_seat] \n                + [\"contested \", \"unopposed uncontested \"][d.unopp];\n        return d;\n    })\n}\nd_distr = d3.index(d_distr_list, d => d.state, d => d.district)\n\nDARK_BLUE = \"#0063B1\"\nDARK_RED = \"#A0442C\"\nBLUE = \"#3D77BB\"\nRED = \"#B25D4C\"\nw_BODY = 796;\nSMALL = width < 600;\nelec_date = new Date(\"2022-11-08\")\n\ncolor = {\n    let midpt = \"#fafffa\";\n    let color_dem = d3.scaleLinear()\n        .domain([0.5, 1.0])\n        .range([midpt, DARK_BLUE]);\n    let color_gop = d3.scaleLinear()\n        .domain([0.0, 0.5])\n        .range([DARK_RED, midpt]);\n    return x => x <= 0.5 ? color_gop(x) : color_dem(x);\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"{\nlet exag_fac = 1 - Math.sqrt(width)/80;\nlet last_elec = 222;\nlet xmin = Math.max(Math.min(d_sum.house_q10*exag_fac, 218 - 10), 0)\nlet xmax = Math.min(Math.max(d_sum.house_q90/exag_fac, 218 + 10), 435)\nlet s_gain = \"-\" + Math.abs(last_elec - Math.round(d_sum.house_med));\nlet overl = Math.max(0.58, 1 - Math.sqrt(width) / 80);\n\nlet text_shadow = function(text, opt) {\n    let opt2 = {...opt}\n    opt2.dx = opt2.dx + 3\n    opt2.dy = opt2.dy + 3\n    opt2.fill = \"#0007\"\n    return [Plot.text([text], opt2), Plot.text([text], opt)]\n}\n\nwindow.plot = Plot.plot({\n    x: {\n        domain: [xmin, xmax],\n        clamp: true,\n        inset: 10,\n        tickSize: 8,\n        reverse: true,\n    },\n    y: {\n        legend: false,\n        axis: null,\n        insetTop: 4,\n    },\n    color: {\n        legend: false,\n    },\n    marks: [\n        Plot.rectY(d_hist, {\n                x1: d => d.dem_seats - overl,\n                x2: d => d.dem_seats + overl,\n                y: \"pr\",\n                fill: d => d.dem_seats >= 218 ? BLUE : RED,\n            }),\n        Plot.ruleY([0]),\n        Plot.ruleY([0], {\n            dy: 2,\n            strokeWidth: 5,\n            x1: d_sum.house_q10,\n            x2: d_sum.house_q90,\n            color: \"red\",\n            }),\n        Plot.ruleX([last_elec, d_sum.house_med]),\n        text_shadow(s_gain, { \n            x: d_sum.house_med, dy: -48, dx: 3,\n            frameAnchor: \"bottom\", textAnchor: \"start\", lineAnchor: \"bottom\",\n            fill: \"white\", fontSize: 40, fontWeight: \"bold\",\n            }),\n        text_shadow(\"LOSS\", { \n            x: d_sum.house_med, dy: -42, dx: 5,\n            frameAnchor: \"bottom\", textAnchor: \"start\", lineAnchor: \"top\",\n            fill: \"white\", fontSize: 14, fontWeight: \"bold\",\n            }),\n        Plot.text([\"← DEM. MAJORITY\"], { \n            x: 217.5, dy: -4, dx: -3,\n            frameAnchor: \"bottom\", textAnchor: \"end\",\n            fontWeight: \"bold\", fill: \"#111\",\n            }),\n        Plot.text([\"REP. MAJORITY →\"], { \n            x: 217.5, dy: -4, dx: 3,\n            frameAnchor: \"bottom\", textAnchor: \"start\",\n            fontWeight: \"bold\", fill: \"#111\",\n            }),\n         Plot.text([last_elec + \" LAST ELECTION\"], { \n            x: last_elec, dy: -4,\n            frameAnchor: \"top\", textAnchor: \"middle\", lineAnchor: \"bottom\",\n            fontWeight: \"bold\",\n            }),\n         Plot.text([\"← DEM. SEATS\"], { \n            x: xmax, dy: -4 - (SMALL ? 10 : 0), dx: 4,\n            frameAnchor: \"bottom\", textAnchor: \"start\",\n            fontWeight: \"bold\",\n            }),\n    ],\n    \n    width: width,\n    height: 240,\n    marginBottom: 0,\n    marginLeft: 0,\n    marginRight: 0,\n    \n    style: {\n        fontSize: 9,\n        color: \"#444\",\n        overflow: \"visible\",\n    }\n})\nreturn window.plot;\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-3","inline":false,"source":"\ndem_lead = true; // d_sum.house_prob > 0.5\n{\n    let win_party = dem_lead ? \"Democrats\" : \"Republicans\"\n    let win_class = dem_lead ? \"dem\" : \"rep\"\n    let min_seats = dem_lead ? d_sum.house_q10 : 435 - d_sum.house_q90\n    let max_seats = dem_lead ? d_sum.house_q90 : 435 - d_sum.house_q10\n    let phrase = dem_lead ? \"controlling\" : \"flipping\"\n    let prob = dem_lead ? d_sum.house_prob : 1 - d_sum.house_prob\n    let timestamp = d_history[d_history.length-1].timestamp;\n    let date_fmt = timestamp.toLocaleString(\"en-US\", { \n            weekday: \"long\", \n            month: \"long\", \n            day: \"numeric\", \n            hour: \"numeric\", \n            minute: \"numeric\",\n            timeZoneName: \"short\",\n            })       \n\n    return md`\nThe <b class=\"${win_class}\">${win_party}</b> are expected to win\n**between ${min_seats} and ${max_seats} seats**.\n\nThey have a **${fmt_pct(prob)} chance** of ${phrase} the House.\n\n<p class=\"updated\">Last updated ${date_fmt}.</p>`;\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-4","inline":false,"source":"{\nlet distrs = topojson.feature(geom_hex, geom_hex.objects.foo).features.map(d => {\n    d.match = d_distr.get(d.properties.state).get(d.properties.district);\n    d.flip = ((d.match.pr_dem > 0.5 && d.match.inc_seat == \"gop\") \n                || (d.match.pr_dem < 0.5 && d.match.inc_seat == \"dem\"))\n            && (Math.abs(d.match.pr_dem - 0.5) > 0.01);\n    return d;\n})\n    \nconst w = 960;\nconst h = w * 0.72;\nconst GOLD = \"#bc1\";\n\nconst svg = d3\n    .create(\"svg\")\n    .attr(\"viewBox\", [0, 0, w, h])\n    .style(\"width\", \"100%\")\n    .style(\"height\", \"auto\");\n\nlet proj = d3.geoAlbers()\n    .scale(0.9*w)\n    .translate([0.97*w/2, 0.91*h/2]);\nlet path = d3.geoPath(proj);\n\nlet geom_distrs = svg\n    .append(\"g\")\n    .attr(\"class\", \"distrs\")\n    .selectAll(\"path\")\n    .data(distrs)\n    .enter().append(\"path\")\n    .attr(\"fill\", d => color(d.match.pr_dem))\n    .attr(\"stroke\", \"#111\")\n    .attr(\"stroke-width\", 0.5)\n    .attr(\"d\", path);\n\nlet geom_distrs_hover = svg\n    .append(\"g\")\n    .attr(\"class\", \"distrs\")\n    .selectAll(\"path\")\n    .data(distrs)\n    .enter().append(\"path\")\n    .attr(\"fill\", d => d.flip ? \"url(#diagonalHatch)\" : \"none\")\n    .attr(\"stroke\", \"#000\")\n    .attr(\"stroke-width\", 0.0)\n    .attr(\"d\", path);    \n\nlet tt = d3.select(\"#plot-map\").append(\"div\")\n        .attr(\"class\", \"map-tooltip\")\n        .style(\"visibility\", \"hidden\");\n    \nlet mmv = function(e, d) {\n    let [mx, my] = d3.pointer(e);\n    let svg_dim = svg.node().getBoundingClientRect();\n    let w_fac = svg_dim.width/w;\n    if (mx < 50/w_fac) mx = 50/w_fac;\n    if (mx > w - 190/w_fac) mx = w - 190/w_fac;\n    \n    let prob = d.match.pr_dem;\n    let cand;\n    let miss;\n    if (prob > 0.5) {\n        cand = !d.match.dem_cand ? \"Democrats\" : d.match.dem_cand;\n        miss = !d.match.dem_cand;\n    } else {\n        cand = !d.match.rep_cand ? \"Republicans\" : d.match.rep_cand;\n        miss = !d.match.rep_cand;\n    }\n    let inc = {\n        dem: `<b style='color: ${DARK_BLUE}'>Dem.</b> incumbent`,\n        gop: `<b style='color: ${DARK_RED}'>Rep.</b> incumbent`,\n        open: \"<b>Open</b> seat\",\n    }[d.match.inc_seat]\n    let prob_text;\n    let prob_color = prob > 0.5 ? DARK_BLUE : DARK_RED;\n    if (d.match.unopp == 1) {\n        prob_text = `<b style=\"color: ${prob_color}\">${cand}</b>\n            ${miss ? \"are\" : \"is\"} running unopposed and will win the seat.`\n    } else {\n        prob_text = `<b style=\"color: ${prob_color}\">${cand}</b> \n            ${miss ? \"have\" : \"has\"} a \n            <b>${fmt_pct(prob > 0.5 ? prob : 1 - prob)}</b> chance of winning.`\n    }\n    let disclaimer = d.match.rcv ? `<p style=\"color: #777; font-size: 0.75em; font-style: italic; margin-top: 0.5em;\">\n        Estimates do not account for rank-choice voting.\n    </p>` : \"\";\n    \n    d3.select(this).attr(\"stroke-width\", 2.4);\n    \n    let txt = `<h3>${d.match.name}</h3>\n        <p>${inc}</p>\n        <div style=\"width: 100%; height: 1rem; margin: 4px 0; display: flex;\">\n        <div style=\"background: ${BLUE}; flex-basis: ${100*prob}%\"></div>\n        <div style=\"background: ${RED}; flex-basis: ${100 - 100*prob}%\"></div>\n        </div>\n        <p>${prob_text}</p>\n        ${disclaimer}\n        `;\n\n    tt.style(\"visibility\", \"visible\")\n      .html(txt)\n      .style(\"left\", (mx - 50)*svg_dim.width/w + \"px\")\n      .style(\"bottom\", (h - my + 25)*svg_dim.height/h + \"px\");\n}\nlet mout = function(d) {\n    geom_distrs_hover.attr(\"stroke-width\", 0.0);\n    tt.style(\"visibility\", \"hidden\");\n}\n\ngeom_distrs_hover.on(\"mousemove\", mmv);\ngeom_distrs_hover.on(\"touchmove\", mmv);\nsvg.on(\"mouseout\", mout);\nsvg.on(\"touchend\", mout);\n\nreturn svg.node();\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-5","inline":false,"source":"plot_gcb = {\n    let d_gcb = await FileAttachment(\"natl_intent.csv\").csv({typed: true});\n    const ci_w = d_sum.i_q90 - d_sum.i_q10\n    const ymin = Math.max(Math.min(d_sum.i_med - 1*ci_w, 0.45), 0)\n    const ymax = Math.min(Math.max(d_sum.i_med + 1*ci_w, 0.52), 1)\n    const today = Math.min(elec_date, Date.now());\n    const days_til = (elec_date - today) / (24 * 3600 * 1000);\n    \n    return Plot.plot({\n        y: {\n            label: null,\n            domain: [ymin, ymax],\n            grid: true,\n            tickFormat: \"%\",\n            axis: \"right\",\n            ticks: 5,\n        },\n        x: {label: null},\n        \n        marks: [\n            Plot.areaY(d_gcb, {\n                    x: \"date\",\n                    y1: d => Math.max(d.q10, 0.5),\n                    y2: d => Math.max(d.q90, 0.5),\n                    fill: BLUE, opacity: 0.4,\n                }),\n            Plot.areaY(d_gcb, {\n                    x: \"date\",\n                    y1: d => Math.max(d.q25, 0.5),\n                    y2: d => Math.max(d.q75, 0.5),\n                    fill: BLUE, opacity: 0.4,\n                }),\n            Plot.areaY(d_gcb, {\n                    x: \"date\",\n                    y1: d => Math.min(d.q10, 0.5),\n                    y2: d => Math.min(d.q90, 0.5),\n                    fill: RED, opacity: 0.4,\n                }),\n            Plot.areaY(d_gcb, {\n                    x: \"date\",\n                    y1: d => Math.min(d.q25, 0.5),\n                    y2: d => Math.min(d.q75, 0.5),\n                    fill: RED, opacity: 0.4,\n                }),\n            Plot.line(d_gcb.filter(d => d.date <= today), \n                    {x: \"date\", y: \"natl_dem\", strokeWidth: 3}),\n            Plot.line(d_gcb.filter(d => d.date >= today), \n                    {x: \"date\", y: \"natl_dem\", strokeWidth: 3, \n                    strokeDasharray: \"4,3\", strokeLinecap: \"butt\" }),\n            \n            Plot.ruleY([0.5], {stroke: \"#0007\"}),\n            Plot.rect([0], {\n                    x1: today, x2: elec_date, y1: ymin, y2: ymax,\n                    fill: \"#fff7\",\n                }),\n            Plot.ruleX([elec_date, today]),\n            \n            Plot.text([SMALL ? \"Estimated Dem. vote\" : \"Estimated Democratic two-party vote\"], { \n                    x: d3.min(d_gcb, d => d.date), dy: -4,\n                    frameAnchor: \"top\", textAnchor: \"start\", lineAnchor: \"bottom\",\n                    fontWeight: \"bold\", fontSize: 15,\n                }),\n            Plot.text([days_til > 20 + SMALL*30 ? \"TODAY\" : \"\"], { \n                    x: today, dy: -4,\n                    frameAnchor: \"top\", textAnchor: \"middle\", lineAnchor: \"bottom\",\n                    fontWeight: \"bold\",\n                }),\n            Plot.text([\"ELECTION DAY\"], { \n                    x: elec_date, dy: -4,\n                    frameAnchor: \"top\", textAnchor: \"middle\", lineAnchor: \"bottom\",\n                    fontWeight: \"bold\",\n                }),\n            Plot.text([fmt_pct(d_sum.i_med, 1)], { \n                    x: elec_date, y: d_sum.i_med, dy: -6, dx: -4,\n                    frameAnchor: \"top\", textAnchor: \"end\", lineAnchor: \"bottom\",\n                    fontWeight: \"bold\", fontSize: 15, fill: \"#223\",\n                }),\n        ],\n        \n        width: Math.min(w_BODY, width),\n        height: 300,\n        marginRight: 40,\n        \n        style: {\n        }\n    })\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-6","inline":false,"source":"d_shift = FileAttachment(\"house_shifts.csv\").csv({typed: true})\nwindow.d_shift = d_shift\n"},{"methodName":"interpret","cellName":"ojs-cell-7","inline":false,"source":"Plot.plot({\n    x: {\n        domain: [0.45, 0.535],\n        tickFormat: \"%\",\n        label: \"National Democratic vote share\",\n        grid: true,\n    },\n    y: {\n        grid: true,\n        line: true,\n        domain: [150, 270],\n        label: \"Democratic seats won\",\n    },\n    marks: [\n        Plot.ruleY([217.5], {stroke: \"#0007\"}),\n        Plot.ruleX([0.50], {stroke: \"#0004\"}),\n        Plot.ruleX(d_shift, {\n            x: \"natl\",\n            y1: \"q01\", \n            y2: \"q99\",\n            strokeWidth: 1.4,\n            clip: true,\n        }),\n        Plot.ruleX(d_shift, {\n            x: \"natl\",\n            y: \"q10\", \n            y2: \"q90\",\n            strokeWidth: 4,\n            clip: true,\n        }),\n        Plot.rect(d_shift, {\n            x1: x => x.natl - 0.002, \n            x2: x => x.natl + 0.002, \n            y1: \"q25\", \n            y2: \"q75\",\n            stroke: \"black\",\n            strokeWidth: 0.8,\n            fill: x => color(x.pr_win),\n            clip: true,\n        }),\n        Plot.text([\"Majority\"], { \n                y: 218, dy: -2, dx: 3,\n                frameAnchor: \"left\", textAnchor: \"start\", lineAnchor: \"bottom\",\n            }),\n        () => Plot.plot({\n            x: {\n                domain: [0.45, 0.535],\n                axis: null\n            },\n            y: {\n                grid: false,\n                domain: [150 - 222, 270 - 222],\n                transform: x => x - 222,\n                axis: \"right\", \n                line: true,\n                tickSize: -4,\n                tickFormat: x => (x >= 0 ? \"+\" : \"\") + x,\n                label: \"Seats gained or lost\",\n            },\n            marks: [\n                Plot.ruleY(d_shift, {\n                    x1: x => x.natl - 0.002, \n                    x2: x => x.natl + 0.002, \n                    y: \"q50\", \n                    strokeWidth: 3,\n                    clip: true,\n                })\n            ],\n            \n            width: Math.min(w_BODY, width),\n            height: 400,\n            marginLeft: 40,\n            marginRight: 40,\n            marginBottom: 40,\n        })\n    ],\n    \n    width: Math.min(w_BODY, width),\n    height: 400,\n    marginRight: 40,\n    marginLeft: 40,\n    marginBottom: 40,\n    \n    style: {\n    }\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-8","inline":false,"source":"viewof search = Inputs.search(d_distr_list, {\n    label: \"Districts:\",\n    columns: [\"name\", \"state\", \"inc_seat\", \"search\", \"rating\", \"dem_cand\", \"rep_cand\"],\n    autocomplete: false,\n    width: Math.min(width - 8, w_BODY),\n})\n\nmd`Democrats are expected to win **${d3.sum(tab_distr, d => d.pr_dem).toFixed(1)}\nof the ${tab_distr.length}** districts selected below, on average.`\n"},{"methodName":"interpret","cellName":"ojs-cell-9","inline":false,"source":"viewof tab_distr = {\n    let fmt_name = function(x) {\n        return html`<span style=\"font-weight: 500; font-size: ${small ? 0.85 : 1.0}em;\">${x}</span>`\n    }\n    let fmt_inc = function(x) {\n        return html`<span class=\"inc\" style=\"color: ${{dem: DARK_BLUE, gop: DARK_RED, open: \"black\"}[x]}\">\n            ${{dem: \"Dem.\", gop: \"Rep.\", open: \"Open\"}[x]}\n            </span>`\n    }\n    let fmt_part = function(x) {\n        if (x === null) {\n            return html`<span style=\"color: #777\">&ndash;</span>`\n        } else {\n            let color = x > 0.5 ? DARK_BLUE : DARK_RED;\n            return html`<span style=\"color: ${color}\">${fmt_pct(x, 1)}</span>`\n        }\n    }\n    let fmt_prob = function(x) {\n        let tcolor = Math.abs(x - 0.5) > 0.3 ? \"#fffc\" : \"black\";\n        return html`<div class=\"chip\" style=\"background: ${color(x)}; color: ${tcolor}\">\n            ${fmt_pct(x)}</div>`\n    }\n    \n    let xmin = d3.min(d_distr_list, d => d.dem_q10)\n    let xmax = d3.max(d_distr_list, d => d.dem_q90)\n    let avg = 50*(xmin + xmax);\n    let x = d3.scaleLinear().domain([xmax, xmin]).range([0, 100]);\n    let x_dem = d3.scaleLinear().domain([xmax, 0.5]).range([0, avg]).clamp(true);\n    let x_rep = d3.scaleLinear().domain([0.5, xmin]).range([avg, 100]).clamp(true);\n    let ici_d = BLUE + \"bb\";\n    let oci_d = BLUE + \"77\";\n    let ici_r = RED + \"cc\";\n    let oci_r = RED + \"88\";\n    let fmt_vs = function(int) {\n        if (int[0] === null) {\n            return html`<div style=\"text-align: center; color: #777; font-size: 0.85em;\">(Unopposed)</div>`\n        } else {\n            let gr = `linear-gradient(90deg, transparent 0%,\n               transparent ${x_dem(int[4])}%, ${oci_d} ${x_dem(int[4])}%, \n               ${oci_d} ${x_dem(int[3])}%, ${ici_d} ${x_dem(int[3])}%,\n               ${ici_d} ${x_dem(int[2])}%, ${oci_d} ${x_dem(int[2])}%,\n               ${oci_d} ${x_dem(int[1])}%, transparent ${x_dem(int[1])}%,\n               transparent ${x_rep(int[4])}%,  ${oci_r} ${x_rep(int[4])}%, \n               ${oci_r} ${x_rep(int[3])}%, ${ici_r} ${x_rep(int[3])}%,\n               ${ici_r} ${x_rep(int[2])}%, ${oci_r} ${x_rep(int[2])}%,\n               ${oci_r} ${x_rep(int[1])}%, transparent ${x_rep(int[1])}%,\n               transparent 100%)`;\n            let disclaimer = int[5] ? \"&dagger;\" : \"\"; // RCV\n            return html`\n                <div class=\"est\" style=\"background: ${gr}; \n                    padding-left: calc(${x(int[0])}% - 6px);\">\n                &#x25cf;&nbsp;${fmt_pct(int[0])}${disclaimer}</div>\n                `;\n        }\n    }\n    let fmt_vs_tiny = function(int) {\n        if (int[0] === null) {\n            return html`<span style=\"color: #777; font-size: 0.85em;\">(Unopp.)</span>`\n        } else {\n            let color = int[0] > 0.5 ? DARK_BLUE : DARK_RED;\n            let disclaimer = int[5] ? \"&dagger;\" : \"\"; // RCV\n            return html`<span style=\"color: ${color};\">${fmt_pct(int[0], 1)}${disclaimer}</span>`;\n        }\n    }\n    \n    let fmt_cands = function(x) {\n        let na_html = \"<span style='color: #777'>&ndash;</span>\";\n        let d_cand = x[0] === null ? na_html : x[0];\n        let r_cand = x[1] === null ? na_html : x[1];\n        if (SMALL) {\n            if (x[2] == \"dem\") { // incumbent\n                d_cand += \"*\"\n            } else if (x[2] == \"rep\") {\n                r_cand += \"*\"\n            }\n        }\n        return html`<div class=\"ddem cand\">${d_cand}</div>\n        <div class=\"drep cand\">${r_cand}</div>`\n    }\n    \n    let cols = [\"margin\", \"name_short\", \"cands\", \"inc_seat\", \"pr_dem\", \"interval\", \"part_base\", ];\n    let cols_small = [\"margin\", \"name_short\", \"cands\", \"pr_dem\", \"interval\", \"part_base\", ];\n    let cols_tiny = [\"margin\", \"name_short\", \"cands\", \"pr_dem\", \"interval\", ];\n    const tiny = width < 496;\n    const small = width < 650\n    \n    return Inputs.table(search, {\n        columns: small ? (tiny ? cols_tiny : cols_small) : cols,\n        \n        header: {\n            name_short: small ? \"Distr.\" : \"District\",\n            inc_seat: \"Inc.\",\n            cands: \"Candidates\",\n            pr_dem: small ? \"Prob.\" : \"Dem. prob.\",\n            interval: small ? \"Est. vote\" : \"Vote forecast\",\n            part_base: small ? \"Lean\" : \"Part. Lean\",\n        },\n        \n        format: {\n            name_short: fmt_name,\n            inc_seat: fmt_inc,\n            pr_dem: fmt_prob,\n            cands: fmt_cands,\n            interval: tiny ? fmt_vs_tiny : fmt_vs,\n            part_base: fmt_part,\n        },\n        \n        sort: \"margin\",\n        \n        width: {\n            interval: 400,\n        },\n        maxWidth: Math.min(w_BODY, width),\n        \n        rows: 30,\n        layout: \"fixed\",\n    })\n}\n\nSMALL ? html`<small style=\"color: #777\">*Incumbent candidate</small>` : html``\n"},{"methodName":"interpret","cellName":"ojs-cell-10","inline":false,"source":"plot_prob = {\n    const today = d3.max(d_history, d => d.from_date);\n    const days_til = (elec_date - today) / (24 * 3600 * 1000);\n    \n    return Plot.plot({\n        y: {\n            label: null,\n            domain: [0, 1],\n            grid: true,\n            tickFormat: \"%\",\n            axis: \"right\",\n            ticks: [0, 0.25, 0.5, 0.75, 1],\n            insetTop: 4,\n        },\n        x: {label: null},\n        \n        marks: [\n            Plot.line(d_history, {x: \"from_date\", y: \"house_prob\", strokeWidth: 3, stroke: BLUE}),\n            Plot.line(d_history, {x: \"from_date\", y: d => 1 - d.house_prob, strokeWidth: 3, stroke: RED}),\n            \n            Plot.ruleY([0.5], {stroke: \"#0007\"}),\n            Plot.ruleX([elec_date, today]),\n            \n            Plot.text([\"Odds of winning House\"], { \n                    x: d3.min(d_history, d => d.from_date), dy: -4,\n                    frameAnchor: \"top\", textAnchor: \"start\", lineAnchor: \"bottom\",\n                    fontWeight: \"bold\", fontSize: 15,\n                }),\n            Plot.text([days_til > 20 + SMALL*30 ? \"TODAY\" : \"\"], { \n                    x: today, dy: -4,\n                    frameAnchor: \"top\", textAnchor: \"middle\", lineAnchor: \"bottom\",\n                    fontWeight: \"bold\",\n                }),\n            Plot.text([\"ELECTION DAY\"], { \n                    x: elec_date, dy: -4,\n                    frameAnchor: \"top\", textAnchor: \"middle\", lineAnchor: \"bottom\",\n                    fontWeight: \"bold\",\n                }),\n            Plot.text([fmt_pct(d_sum.house_prob)], { \n                    x: today, y: d_sum.house_prob, dy: -6, dx: 4,\n                    frameAnchor: \"top\", textAnchor: \"start\", \n                    fontWeight: \"bold\", fontSize: 15, fill: BLUE, \n                    stroke: \"white\", strokeWidth: 4,\n                }),\n            Plot.text([fmt_pct(1 - d_sum.house_prob)], { \n                    x: today, y: 1 - d_sum.house_prob, dy: -6, dx: 4,\n                    frameAnchor: \"top\", textAnchor: \"start\", \n                    fontWeight: \"bold\", fontSize: 15, fill: RED,\n                    stroke: \"white\", strokeWidth: 4,\n                }),\n        ],\n        \n        width: width < 768 ? width : Math.min(w_BODY, width) * 0.48,\n        height: 300,\n        marginRight: 40,\n        marginLeft: 0,\n    })\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-11","inline":false,"source":"plot_gcb_prob = {\n    const today = d3.max(d_history, d => d.from_date);\n    const days_til = (elec_date - today) / (24 * 3600 * 1000);\n    \n    return Plot.plot({\n        y: {\n            label: null,\n            domain: [0, 1],\n            grid: true,\n            tickFormat: \"%\",\n            axis: \"right\",\n            ticks: [0, 0.25, 0.5, 0.75, 1],\n            insetTop: 4,\n        },\n        x: {label: null},\n        \n        marks: [\n            Plot.line(d_history, {x: \"from_date\", y: \"i_prob\", strokeWidth: 3, stroke: BLUE}),\n            Plot.line(d_history, {x: \"from_date\", y: d => 1 - d.i_prob, strokeWidth: 3, stroke: RED}),\n            \n            Plot.ruleY([0.5], {stroke: \"#0007\"}),\n            Plot.ruleX([elec_date, today]),\n            \n            Plot.text([\"Odds of winning pop. vote\"], { \n                    x: d3.min(d_history, d => d.from_date), dy: -4,\n                    frameAnchor: \"top\", textAnchor: \"start\", lineAnchor: \"bottom\",\n                    fontWeight: \"bold\", fontSize: 15,\n                }),\n            Plot.text([days_til > 20 + SMALL*30 ? \"TODAY\" : \"\"], { \n                    x: today, dy: -4,\n                    frameAnchor: \"top\", textAnchor: \"middle\", lineAnchor: \"bottom\",\n                    fontWeight: \"bold\",\n                }),\n            Plot.text([\"ELECTION DAY\"], { \n                    x: elec_date, dy: -4,\n                    frameAnchor: \"top\", textAnchor: \"middle\", lineAnchor: \"bottom\",\n                    fontWeight: \"bold\",\n                }),\n            Plot.text([fmt_pct(d_sum.i_prob)], { \n                    x: today, y: d_sum.i_prob, dy: -6, dx: 4,\n                    frameAnchor: \"top\", textAnchor: \"start\", \n                    fontWeight: \"bold\", fontSize: 15, fill: BLUE, \n                    stroke: \"white\", strokeWidth: 4,\n                }),\n            Plot.text([fmt_pct(1 - d_sum.i_prob)], { \n                    x: today, y: 1 - d_sum.i_prob, dy: -6, dx: 4,\n                    frameAnchor: \"top\", textAnchor: \"start\", \n                    fontWeight: \"bold\", fontSize: 15, fill: RED,\n                    stroke: \"white\", strokeWidth: 4,\n                }),\n        ],\n        \n        width: width < 768 ? width : Math.min(w_BODY, width) * 0.48,\n        height: 300,\n        marginRight: 40,\n        marginLeft: 0,\n    })\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-12","inline":false,"source":"plot_hist_seats = {\n    const today = d3.max(d_history, d => d.from_date);\n    const days_til = (elec_date - today) / (24 * 3600 * 1000);\n    const ymin = d3.min(d_history, d => d.house_q10) * 0.9;\n    const ymax = d3.max(d_history, d => d.house_q90) / 0.9;\n    \n    return Plot.plot({\n        y: {\n            label: null,\n            domain: [ymin, ymax],\n            grid: true,\n            axis: \"right\",\n            ticks: 5,\n            insetTop: 4,\n        },\n        x: {label: null},\n        \n        marks: [\n            Plot.areaY(d_history, {\n                    x: \"from_date\",\n                    y1: d => Math.max(d.house_q10, 217.5),\n                    y2: d => Math.max(d.house_q90, 217.5),\n                    fill: BLUE, opacity: 0.4,\n                }),\n            Plot.areaY(d_history, {\n                    x: \"from_date\",\n                    y1: d => Math.max(d.house_q25, 217.5),\n                    y2: d => Math.max(d.house_q75, 217.5),\n                    fill: BLUE, opacity: 0.4,\n                }),\n            Plot.areaY(d_history, {\n                    x: \"from_date\",\n                    y1: d => Math.min(d.house_q10, 217.5),\n                    y2: d => Math.min(d.house_q90, 217.5),\n                    fill: RED, opacity: 0.4,\n                }),\n            Plot.areaY(d_history, {\n                    x: \"from_date\",\n                    y1: d => Math.min(d.house_q25, 217.5),\n                    y2: d => Math.min(d.house_q75, 217.5),\n                    fill: RED, opacity: 0.4,\n                }),\n            Plot.line(d_history, {x: \"from_date\", y: \"house_med\", strokeWidth: 3}),\n            \n            Plot.ruleY([217.5], {stroke: \"#0007\"}),\n            Plot.ruleX([elec_date, today]),\n            \n            Plot.text([SMALL ? \"Forecasted Dem. seats\" : \"Forecasted Democratic seats won\"], { \n                    x: d3.min(d_history, d => d.from_date), dy: -4,\n                    frameAnchor: \"top\", textAnchor: \"start\", lineAnchor: \"bottom\",\n                    fontWeight: \"bold\", fontSize: 15,\n                }),\n            Plot.text([days_til > 20 + SMALL*30 ? \"TODAY\" : \"\"], { \n                    x: today, dy: -4,\n                    frameAnchor: \"top\", textAnchor: \"middle\", lineAnchor: \"bottom\",\n                    fontWeight: \"bold\",\n                }),\n            Plot.text([\"ELECTION DAY\"], { \n                    x: elec_date, dy: -4,\n                    frameAnchor: \"top\", textAnchor: \"middle\", lineAnchor: \"bottom\",\n                    fontWeight: \"bold\",\n                }),\n            Plot.text([d_sum.house_med], { \n                    x: today, y: d_sum.house_med, dy: -6, dx: 4,\n                    frameAnchor: \"top\", textAnchor: \"start\", \n                    fontWeight: \"bold\", fontSize: 15, fill: \"#223\",\n                }),\n        ],\n        \n        width: Math.min(w_BODY, width),\n        height: 300,\n        marginRight: 40,\n        marginLeft: 0,\n    })\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-13","inline":false,"source":"{\n    let d_polls = await FileAttachment(\"polls.csv\").csv({typed: true});\n    d_polls = d_polls.map(d => {\n        d.lv_type = [d.lv, d.type];\n        return d;\n    });\n    \n    let fmt_firm = x => html`<div class=\"firm\">${x}</div>`;\n    let fmt_date = x => html`<span class=\"date\">${x.toLocaleString(\"en-US\", { month: 'short', day: 'numeric' })}</span>`;\n    let fmt_type = function(x) {\n        let type = x[1] == \"unknown\" ? \"&ndash;\" : x[1].toUpperCase();\n        let lv = x[0] == 1 ? \"LV\" : \"RV/Adults\";\n        return html`<div class=\"poll-type\">${type}</div>\n            <div class=\"poll-lv\">${lv}</div>`\n    }\n    let fmt_bias = function(x) {\n        let color = x > 0.0 ? DARK_BLUE : DARK_RED;\n        let prefix = x > 0.0 ? \"D\" : \"R\";\n        return html`<span style=\"color: ${color}; font-size: ${SMALL ? 0.75 : 0.9}em;\">\n            ${prefix}+${(100*Math.abs(x)).toFixed(1)}</span>`;\n    }\n    let fmt_est = function(x) {\n        return html`<div class=\"chip\" style=\"background: ${color(5*x-2)};\">\n            ${fmt_pct(x, 1)}</div>`;\n    }\n    let fmt_impact = function(x) {\n        let tcolor = x > 0.0 ? \"#006381\" : \"#80442C\";\n        let prefix = x > 0.0 ? \"D\" : \"R\";\n        return html`<div class=\"chip\" style=\"background: ${color(0.5+x)}; color: ${tcolor};\">\n            ${prefix}+${Math.abs(x).toFixed(2)}</div>`\n    }\n    \n\n    let cols = [\"date\", \"firm\", \"firm_bias\", \"lv_type\", \"est\", \"impact\"];\n    let cols_small = [\"date\", \"firm\", \"firm_bias\", \"est\", \"impact\"];\n    \n    return Inputs.table(d_polls, {\n        columns: SMALL ? cols_small : cols,\n        \n        header: {\n            date: \"Date\",\n            firm: SMALL ? \"Firm\" : \"Polling firm\",\n            firm_bias: SMALL ? \"Bias\" : \"Firm bias\",\n            lv_type: \"Poll type\",\n            est: SMALL ? \"Result\" : \"Poll result\",\n            impact: \"Impact\",\n        },\n        \n        format: {\n            date: fmt_date,\n            firm: fmt_firm,\n            firm_bias: fmt_bias,\n            lv_type: fmt_type,\n            est: fmt_est,\n            impact: fmt_impact,\n        },\n        \n        width: {\n            firm: SMALL ? 120 : 350,\n            impact: SMALL ? 50 : 80,\n        },\n        maxWidth: Math.min(w_BODY, width),\n        \n        rows: 20,\n        layout: \"fixed\",\n    })\n}\n"},{"methodName":"interpretQuiet","source":"shinyInput('search')"},{"methodName":"interpretQuiet","source":"shinyInput('tab_distr')"}]}
</script>
<script type="module">
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
</div> <!-- /content -->



</body></html>